"use strict";function DefaultSettings(){function n(){var e={power_level:r.power_level,difficulty:r.difficulty,language:r.language},t=JSON.parse(localStorage.getItem("vermintools"))||{};t.settings=e,localStorage.setItem("vermintools",JSON.stringify(t))}var r={},e=(JSON.parse(localStorage.getItem("vermintools"))||{}).settings||{};r.refresh=[];function o(){for(var e=0;e<r.refresh.length;e++)r.refresh[e]()}return r.max_targets=5,r.anim_cancel=.05,r.power_level=e.power_level||835,r.set_power_level=function(e){var t=e.target,a=t.valueAsNumber;if(isNaN(a))throw"power_level is NaN!";650<a?(a=650,t.value=650):a<15&&(a=15,t.value=15),r.power_level=a+constants.starting_power_level,o(),n()},r.difficulty=e.difficulty||"cataclysm",r.set_difficulty=function(e){var t=e.target.value;if(!constants.difficulties[t])throw"difficulty is not registered!";r.difficulty=t,o(),n()},r.harder_better=!1,r.set_harder_better=function(e){var t=!r.harder_better;e.target.value=t,r.harder_better=t,o()},r.platform=!1,r.set_platform=function(e){var t=e.target.value;r.platform="console"==t,r.difficulty="legend",o()},r.profiles={},r.language=e.language||"en",r.set_language=function(e){var t=e.target.value;t!==r.language&&(r.language=t,n(),loadLocalization(t))},r.link="manshanko.github.io",r}var verminted=DefaultSettings();function InitConstants(){var e={armor_types:["infantry","armored","monster","friendly_fire","berserker","superarmored"],armor_lookup:{infantry:0,armored:1,monster:2,friendly_fire:3,berserker:4,superarmored:5},hit_types:["neither","headshot","critical","both"],attack_types:["light","push","heavy","dot"],dual_profile:["damage_profile_right","damage_profile_left"],characters:{bw_scholar:"sienna",bw_adept:"sienna",bw_unchained:"sienna",es_mercenary:"kruber",es_huntsman:"kruber",es_knight:"kruber",dr_ranger:"bardin",dr_ironbreaker:"bardin",dr_slayer:"bardin",we_waywatcher:"kerillian",we_maidenguard:"kerillian",we_shade:"kerillian",wh_captain:"saltzpyre",wh_bountyhunter:"saltzpyre",wh_zealot:"saltzpyre"},mob_lookup:{skaven_slave:"infantry",skaven_clan_rat:"infantry",chaos_fanatic:"infantry",chaos_marauder:"infantry",beastmen_gor:"infantry",beastmen_ungor_archer:"infantry",skaven_plague_monk:"berserker",chaos_berzerker:"berserker",skaven_storm_vermin:"armored",beastmen_bestigor:"armored",chaos_raider:"infantry",chaos_warrior:"superarmored",chaos_vortex_sorcerer:"infantry",chaos_corruptor_sorcerer:"infantry",skaven_poison_wind_globadier:"infantry",skaven_gutter_runner:"infantry",skaven_warpfire_thrower:"armored",skaven_ratling_gunner:"armored",skaven_pack_master:"monster",beastmen_standard_bearer:"superarmored"},elites:{beastmen_bestigor:!0,skaven_plague_monk:!0,chaos_berzerker:!0,skaven_storm_vermin:!0,chaos_raider:!0,chaos_warrior:!0},difficulties:{cataclysm:!0,cataclysm_2:!0,cataclysm_3:!0,legend:!0,champion:!0,veteran:!0,recruit:!0}};return e}var constants=InitConstants(),UID=0,uniqueID=function(e){if(e.getAttribute("data-id"))return e.getAttribute("data-id");var t=++UID;return e.setAttribute("data-id",t),t},concateObject=function(e){var t="";if("object"==typeof e){var a,n=0;if(e.isArray){n=e.length;for(var r=0;r<n;r++)a[r]=r}else n=(a=Object.keys(e)).length;for(r=0;r<n;r++)t+=concateObject(e[a[r]])}else t+=e;return t},pageSelection=function(e){for(var t=document.getElementsByClassName(e.getAttribute("data-slot"))[0],a=document.getElementsByClassName("main-page"),n=0;n<a.length;n++)a[n]==t?a[n].classList.remove("hide"):a[n].classList.add("hide")},assembleDiv=function(e,t,a,n){var r=n?document.createElement(n):document.createElement("div");return r.classList=e,a&&(r.textContent=a),t.appendChild(r),r},populateElements=function(){document.createDocumentFragment(),document.getElementsByClassName("weapon-list")[0],Object.keys(data.weapons).sort(),constants.characters;for(var e=document.getElementsByClassName("attack")[0],t=0;t<2;t++)for(var a="[data-weapon-slot='"+t+"']",n=document.querySelector(a).getElementsByClassName("attacks-container")[0],r=0;r<9+t;r++){var o=e.cloneNode(!0);n.appendChild(o)}},LOCAL=[],LOCAL_LOOKUP={},LOCAL_WAITING=!0;function localizeText(t,e,a){var n,r=verminted.language;if("undefined"!=typeof localization&&"disabled"!==r){if(n=localization[r]&&localization[r][t],a(n),!0===LOCAL_WAITING){LOCAL_WAITING=!1;for(var o=LOCAL.length-1;0<=o;o--)LOCAL[o](r)}}else a(!1);if(void 0===LOCAL_LOOKUP[e]){var i=LOCAL.length;LOCAL[i]=function(e){a(localization[e]&&localization[e][t])},LOCAL_LOOKUP[e]=i}else LOCAL[LOCAL_LOOKUP[e]]=function(e){a(localization[e]&&localization[e][t])}}function loadLocalization(e){for(var t=0;t<LOCAL.length;t++)LOCAL[t](e)}var GenericMath=function(){var m={clamp:function(e,t,a){return a<=e?a:e<=t?t:e},getPowerPercentage:function(e){var t=constants.min_power_level;return(e-t)/(constants.max_power_level-t)},scalePower:function(e,t){var a=t=t||verminted.power_level,n=verminted.difficulty;"deathwish"===n&&(n="legend");var r=constants.difficulty_settings[n],o=r.power_level_cap,i=constants.max_power_level_cap,s=r.power_level_max_target;o<a?s&&(a=o+s*(a-o)/(i-o)):a=Math.min(a,o);var l=a;if(constants.min_power_level_cap<=a){var c;if(constants.min_power_level_cap+100<=a)c=(a-constants.min_power_level_cap)*(constants.power_level_diff_ratio[e]-1)/9;else c=(a+50*((l-200)/100-1)-constants.min_power_level_cap)*(constants.power_level_diff_ratio[e]-1)/9;l=constants.min_power_level_cap+c}else l=a;return l},getPower:function(e,t,a,n,r){var o,i=a.power_multiplier||t.power_multiplier||constants.default_power_multiplier,s=a.power_multiplier_near||t.power_multiplier_near,l=a.power_multiplier_far||t.power_multiplier_far;return o=s&&l&&0<=r?0===r?s[e]:l[e]:i[e],m.scalePower(e)*o},getCleave:function(e,t){var a=m.scalePower("cleave"),n=e.cleave_coefficient||constants.default_cleave_coefficient,r=constants.cleave.max-constants.cleave.min,o=a*n.attack,i=r*m.getPowerPercentage(o);return verminted.build.weapon[t].multipliers&&(i+=i*verminted.build.weapon[t].multipliers.power_level,isWeaponMelee(getBuildWeapon(t).name)&&(i+=i*verminted.build.weapon[t].power_level_melee,i+=i*verminted.build.weapon[t].power_level_melee_cleave)),i},getArmorMultiplier:function(e,t,a,n,r,o,i){var s,l=a.armor_multiplier||t.armor_multiplier||constants.default_power_multiplier,c=a.armor_multiplier_near||t.armor_multiplier_near,d=a.armor_multiplier_far||t.armor_multiplier_far;return o&&(s=o[e]),s&&s[n]?r&&s[r]||s[n]:c&&d&&0<=i?0===i?r&&0<=c[e][r]?c[e][r]:0<=c[e][n]?c[e][n]:1:r&&0<=d[e][r]?d[e][r]:0<=d[e][n]?d[e][n]:1:r&&0<=l[e][r]?l[e][r]:0<=l[e][n]?l[e][n]:1},getPowerForUnit:function(e,t,a,n,r,o,i,s,l){var c=t.targets&&t.targets[a]||t.default_target,d=n&&t.critical_multiplier;l&&(s=i=0);var _=0;if("attack"===e){var p=m.getArmorMultiplier("attack",t,c,i,s,d,o);_=m.getPower("attack",t,c,d,o),_*=p}else if("impact"===e){var f=m.getArmorMultiplier("impact",t,c,i,s,d,o);_=m.getPower("impact",t,c,d,o),_*=f}return _}};return m},WeaponDamage=function(){var A={},P=GenericMath(),T={},W={};A.getCleave=P.getCleave,P.modifyBoostCurve=function(e,t){for(var a={},n=0,r=e.length;n<r;n++)a[n]=e[n]*t;return a},P.clampCurveValue=function(e,t){var a=Object.keys(e).length-1;return t<0?e[0]:a<t?e[a]:e[t]},P.getBoostCurveMultiplier=function(e,t){var a=(Object.keys(e).length-1)*t,n=Math.floor(a),r=a-Math.floor(a),o=P.clampCurveValue(e,n-1),i=P.clampCurveValue(e,n+0),s=P.clampCurveValue(e,n+1),l=P.clampCurveValue(e,n+2);return(-o/2+3*i/2-3*s/2+l/2)*r*r*r+(o-5*i/2+2*s-l/2)*r*r+(-o/2+s/2)*r+i};var S={headshot:!0,weakspot:!0,protected_weakspot:!0};A.calculateDamage=function(e,t,a,n,r,o,i,s,l,c,d,_,p){var f=data.profiles[e];if(f.no_damage)return 0;var m=f.targets&&f.targets[d]||f.default_target,u=constants.boost_curves[m.boost_curve_type]||constants.boost_curves.default,v=constants.damage_output,g=(verminted.difficulty,0),h=0,b=1,k=1+_;if(p=1+p,S[t]||a||o||i&&1<i){var w;w=1==l||4==l||5==l?1:l;var y=v.max,C=P.getPowerForUnit("attack",f,d,a,t,r,l,c,w),x=y*P.getPowerPercentage(C);(S[t]||a)&&(b=.5*x),(o||i&&0<i)&&(g=x)}var L,B=0,E=""+verminted.difficulty+verminted.power_level+e+d+c+(0+a)+verminted.platform;W[E]?B=W[E]:(B=z.raw(f,d,a,t,r,l,c,v),W[E]=B),n&&(L=g&&B<g&&g*(n-1)||B*(n-1));var N=0,A=0;o&&(N+=[.75,.6,.5,.5,.5,.3][l]);i&&0<i&&(N+=[.75,.3,.75,.5,.5,.2][l]);S[t]&&(0<B?A+=2==l?m&&(m.headshot_boost_boss||m.headshot_boot)||.25:m&&(m.headshot_boost_armor||m.headshot_boost)||.5:5==c&&0==B?A+=m&&(m.headshot_boost_heavy_armor||.25):1==l&&0==B&&(A+=m&&(m.headshot_boost_armor||m.headshot_boost)||.5),"protected_weakspot"==t&&(A*=.25)),"protected_spot"==t&&(N-=.5,A-=.5),f&&f.no_headshot_boost&&(A=0);var T=0;if(a&&(T=f.crit_boost||.5,f.no_crit_boost&&(T=0)),u&&(0<N||0<A||0<T)){var O=m&&m.power_boost_curve_coefficient||1,I=m&&m.boost_curve_coefficient||1;if(i&&0<i&&(O*=i,I*=i),0<N){var M=E+N;W[M]?g=W[M]:(g=z.power_boost(B,g,1,N,u,O),W[M]=g)}if(0<A||0<T){var j=0<A,D=E+(A=P.clamp(A+T,0,1))+p+k+g;W[D]?h=W[D]:(h=z.headshot(B,g,b,u,I,A,j,p,T,k),W[D]=h)}}return verminted.temp_shade_ult&&2===l&&(B*=.45,g*=.5,h*=.5),B=B+g+h,L&&(B+=L),B};function O(e,t){return t[e]?t[e]:0}A.compileProfile=function(e,t,a,n,r,o){if(r=r||{},o=o||{},"raw"===a)var i=0,s=0,l=0,c=0;else{var d=""+t+(i=verminted.build.weapon[a].crit_boost+O("crit_boost",o))+(s=verminted.build.weapon[a].power_boost+O("power_boost",o))+(l=!!O("armor penetration",o))+(c=verminted.build.weapon[a].headshot_multiplier+O("headshot_multiplier",o))+verminted.platform+verminted.difficulty.charAt(4)+verminted.power_level;if(T[t]===d)return;T[t]=d}for(var _=r.source_type,p={},f=constants.armor_types,m=constants.hit_types,u=verminted.max_targets,v=0,g=f.length;v<g;v++){3===v&&(v=4);var h=v,b=v;5===v&&(h=1);var k=f[v];p[k]={};for(var w=0;w<m.length;w++){var y,C,x,L=m[w];if(verminted.temp_shade_ult){var B=data.profiles[t].boost_override;y=4,2===v?(y=2,B&&(y=Math.min(B,y))):B&&(y=B)}switch(w){case 1:x=!(C="headshot");break;case 2:x=!(C=null);break;case 3:C="headshot",x=!0;break;default:C=null,x=!1}"aoe"!==_&&"dot"!==_&&"na"!==_||(C=null,x=!1,"bleed"===t&&5===v&&0<w&&(C="headshot")),p[k][L]={};for(var E=0;E<u;E++){var N=A.calculateDamage(t,C,x,void 0,0,l,y,void 0,h,b,E,i,c);p[k][L][E]=N}}}if("raw"===a)return p;verminted.profiles[t]=verminted.profiles[t]||{},verminted.profiles[t].crit_boost=i,verminted.profiles[t].power_boost=s,verminted.profiles[t].damage=p};function L(e,t,a){var n=0;return t[e]&&(n+=t[e]),a[e]&&(n+=a[e]),n}var B={infantry:"power_level_unarmoured",armored:"power_level_armoured",monster:"power_level_large",berserker:"power_level_frenzy",skaven:"power_level_skaven",chaos:"power_level_chaos"};A.getDamage=function(e,t,a,n,r,o,i,s,l){l=l||{};var c,d,_,p=getBuildWeapon(a),f=n;data.breeds[f]&&(n=data.breeds[f]),"object"==typeof n?(c=n.primary_armor||n.armor,d=n.race,_=n.hitzone_armor&&n.hitzone_armor.head&&("headshot"===r||"both"===r)?n.hitzone_armor.head:c):(_=c=n,d=void 0),A.compileProfile(e,t,a,0,s,l);var m=c;"superarmored"===c&&(m="armored"),"beastmen"===d&&(d="chaos");var u=B[m],v=B[d],g=verminted.build.weapon[a].multipliers,h=1;if(g=g||{}){var b="power_level_"+data.weapons[e].type,k="increased_weapon_damage_"+data.weapons[e].type,w=1,y=1,C=1;w*=L(b,g,l),y*=L(u,g,l),C*=L(v,g,l),h+=h*L("power_level",g,l),h+=h*L("increased_weapon_damage",g,l),h+=h*L(k,g,l),h+=h*L("damage_taken",g,l),h+=h*L("unbalanced_damage_taken",g,l),p.increased_burn_damage&&(h+="burning_dot"===i||"poison_dot"===i?h*p.increased_burn_damage:h*p.reduced_non_burn_damage),p.power_level_ranged_drakefire&&"DRAKEFIRE"===getWeaponType(e)&&(w+=w*p.power_level_ranged_drakefire),h*=1+w+y+C}var x=verminted.profiles[t].damage[_][r][o]||0;return x*=h};var z={raw:function(e,t,a,n,r,o,i,s){var l=s,c=l.max-l.min,d=P.getPowerForUnit("attack",e,t,a,n,r,o,i),_=P.getPowerPercentage(d);return l.min+c*_},power_boost:function(e,t,a,n,r,o){var i=P.modifyBoostCurve(r,o),s=P.clamp(n,0,1),l=P.getBoostCurveMultiplier(i||r,s);return t=Math.max(Math.max(t,e),a)*l},headshot:function(e,t,a,n,r,o,i,s,l,c){var d=0,_=P.modifyBoostCurve(n,r)||n,p=P.getBoostCurveMultiplier(_,o);return d=Math.max(Math.max(t,e),a)*p,0<l&&(d*=c),i&&(d*=s),d}};return A},GlobalBuffs=function(){var e={},o=[{buff:"defence_debuff_enemies"},{buff:"trait_trinket_grenade_damage_taken_buff"},{buff:"tank_unbalance_buff"},{buff:"damage_boost_potion_increased"},{buff:"speed_boost_potion_increased"},{buff:"markus_huntsman_passive_crit_aura_buff",careers:{es_mercenary:!0,es_knight:!0}},{buff:"markus_mercenary_passive_proc",careers:{es_huntsman:!0,es_knight:!0}}];return e.getGlobalBuffs=function(e){for(var t=[],a=0;a<o.length;a++){var n=o[a];if((0<n.stacks||"list"===e)&&(!n.careers||!(verminted.build&&verminted.build.career&&n.careers[verminted.build.career.name]))){var r=t.length;t[r]={},t[r].name=n.buff,t[r].buff=getBuff(n.buff),t[r].stacks=n.stacks||0}}return t},e.setGlobalBuff=function(e,t){for(var a=0,n=0;n<o.length;n++)if(o[n].buff===e){a=o[n].stacks=t;break}return a},e},TriggerFuncs=function(){var e={on_hit:function(e){var t=!1;return e.attack&&(t=!0),t},on_critical_hit:function(e){var t=!1;return 2!==e.hit_type&&3!==e.hit_type||(t=!0),t},on_critical_action:function(e){var t=!1;return e.attack&&(t=!0),t},on_block:function(e){return!1},on_stagger:function(e){return!1},on_charge_ability_hit_blast:function(e){return!1},on_charge_ability_hit:function(e){return!1},on_special_killed:function(e){return!1},on_damage_dealt:function(e){var t=!1;return(0<e.attack.hit_type||0<e.damage())&&(t=!0),t},on_grenade_user:function(e){return!1},on_spell_used:function(e){return!1},on_enemy_ignited:function(e){var t=!1;return e.dot&&"burning_dot"===e.dot.profile_name&&(t=!0),t},on_full_charge_action:function(e){return!1},on_kill:function(e){return!1},on_backstab:function(e){return!1},on_boss_killed:function(e){return!1},on_gromril_armour_removed:function(e){return!1},on_block_broken:function(e){return!1},on_dodge:function(e){return!1},on_dodge_finished:function(e){return!1},on_leap_start:function(e){return!1},on_leap_finished:function(e){return!1}};return e.on_damage_dealt=function(e){return!1},e.on_damage_taken=function(e){return!1},e.on_timed_block=function(e){return!1},e.on_enemy_pinged=function(e){return!1},e.on_ping_target_killed=function(e){return!1},e.on_last_ammo_used=function(e){return!1},e.on_gained_ammo_from_no_ammo=function(e){return!1},e},BuffFuncs=function(){var i,r={};r.init=function(){i=verminted.build.isTalentActive};function o(e,t,a){s(e,t,a,{debuff:!0})}function n(e,t,a){var n=e[t][e[t].length-1];n.end>a.attack.hit_time&&(n.end=a.attack.hit_time)}var s=function(e,t,a,n){n=n||{};var r=t.name,o=function(e){return Math.floor(1e4*e)/1e4}(a.timeline),i=function(e){return Math.ceil(1e4*e)/1e4}(a.duration||a.timeline+t.duration)||255,s=n.max_stacks||t.max_stacks,l=!1,c=!1,d=!1;if(e[r]&&s?1<s?(c=!0,e[r].length<s&&(l=!0)):t.refresh_durations&&e[r][e[r].length-1].end>o&&(d=!0):l=!0,c)for(var _=0;_<s;_++){0<=(p=e[r].length-(s-_))&&e[r][p].end>o&&(e[r][p].end=i)}if(l){e[r]=e[r]||[];var p=e[r].length;e[r][p]={},e[r][p].start=o,e[r][p].end=i,e[r][p].name=t.name,e[r][p].stat_buff=t.stat_buff,t.multiplier?e[r][p].multiplier=t.multiplier:t.bonus&&(e[r][p].bonus=t.bonus),n.is_debuff&&(e[r][p].debuff=!0)}else if(d){p=e[r].length-1;e[r][p].end=i}};return r.addBuff=function(e,t,a){var n={};isNaN(a)&&(n.duration=255,a=0),n.timeline=a,s(e,t,n)},r.add_buff=function(e,t,a){for(var n=getBuff(t.buff_to_add),r=0;r<n.length;r++){var o=n[r];s(e,o,a)}},r.debuff_defence_grenade_hit=function(e,t,a){if("grenade"===a.attack.source_type){var n=getBuff("trait_trinket_grenade_damage_taken_buff")[0];o(e,n,a)}},r.block_increase_enemy_damage_taken=function(e,t,a){var n=getBuff("defence_debuff_enemies");o(e,n,a)},r.reduce_activated_ability_cooldown_with_internal_cooldown_on_crit=function(e,t,a){},r.ammo_fraction_gain_on_crit_trait=function(e,t,a){},r.ranged_crits_increase_dmg_vs_armour_type=function(e,t,a){var n;switch(a.mob_armor){case 0:n=getBuff("ranged_power_vs_unarmored")[0];break;case 1:n=getBuff("ranged_power_vs_armored")[0];break;case 2:n=getBuff("ranged_power_vs_large")[0];break;case 4:n=getBuff("ranged_power_vs_frenzy")[0]}n&&s(e,n,a)},r.remove_overcharge=function(e,t,a){},r.buff_consecutive_shots_damage=function(e,t,a){var n=getBuff("consecutive_shot_buff")[0],r=getBuff("consecutive_shot_debuff")[0];e.consecutive_shot_debuff?s(e,n,a):o(e,r,a)},r.reduce_activated_ability_cooldown=function(e,t,a){},r.buff_on_stagger_enemy=function(e,t,a){a.hit_elite&&s(e,t,a)},r.unbalance_debuff_on_stagger=function(e,t,a){var n=getBuff("tank_unbalance_buff")[0];o(e,n,a)},r.on_hit_debuff_enemy_defence=function(e,t,a){var n=getBuff("defence_debuff_enemies");o(e,n,a)},r.bardin_ranger_add_power_on_no_ammo_proc=function(e,t,a){var n=getBuff("bardin_ranger_melee_damage_on_no_ammo");s(e,n,a)},r.bardin_ranger_remove_power_on_no_ammo_proc=function(e,t,a){n(e,"bardin_ranger_melee_damage_on_no_ammo",a)},r.add_buff_on_headshot=function(e,t,a){if(1===a.hit_type||3===a.hit_type){var n=getBuff(t.buff_to_add)[0];s(e,n,a)}},r.bardin_ranger_add_reload_speed_buff=function(e,t,a){},r.remove_non_stacking_buff=function(e,t,a){},r.reset_tranquility=function(e,t,a){n(e,"tranquility",a)},r.sienna_adept_add_attack_speed_buff_on_enemies_hit=function(e,t,a){if(a.attack.targets_hit>=t.targets){var n=getBuff(t.buff_to_add)[0];s(e,n,a)}},r.sienna_adept_reduce_activated_ability_cooldown_on_burning_enemy_killed=function(e,t,a){},r.apply_shade_activated_ability=function(e,t,a){},r.end_shade_activated_ability=function(e,t,a){},r.kerillian_shade_stealth_on_backstab_kill=function(e,t,a){},r.ammo_gain=function(e,t,a){},r.kerillian_waywatcher_add_extra_shot_buff_on_melee_kill=function(e,t,a){},r.add_buff_on_ranged_headshot=function(e,t,a){if((1===a.hit_type||3===a.hit_type)&&"RANGED"===getWeaponBuffType(a.attack.weapon_name)){var n=getBuff(t.buff_to_add)[0];s(e,n,a)}},r.kerillian_waywatcher_restore_ammo_on_career_skill_special_kill=function(e,t,a){},r.on_hit_debuff_enemy_defence=function(e,t,a){var n=getBuff("defence_debuff_enemies")[0];o(e,n,a)},r.markus_huntsman_increase_reload_speed=function(e,t,a){},r.restore_ammo_on_special_kill=function(e,t,a){},r.sienna_unchained_activated_ability_power_on_enemies_hit=function(e,t,a){for(var n=0;n<a.attack.targets_hit;n++)r.add_buff(e,t,a)},r.add_buff_on_special_kill=function(e,t,a){a.hit_special&&r.add_buff(e,t,a)},r.sienna_scholar_refund_activated_ability_cooldown=function(e,t,a){},r.bardin_ironbreaker_add_power_buff_on_block=function(e,t,a){r.add_buff(e,t,a)},r.bardin_ironbreaker_remove_on_block_power_buff=function(e,t,a){n(e,"bardin_ironbreaker_power_on_blocked_attacks_buff",a)},r.bardin_ironbreaker_gromril_stagger=function(e,t,a){},r.bardin_ironbreaker_cooldown_reduction_on_kill_while_full_stamina=function(e,t,a){},r.add_bardin_slayer_passive_buff=function(e,t,a){var n=getBuff("bardin_slayer_passive_stacking_damage_buff")[0];i("bardin_slayer_passive_increased_max_stacks")&&(n=getBuff("bardin_slayer_passive_increased_max_stacks")[0]),s(e,n,a)},r.bardin_slayer_push_on_dodge=function(e,t,a){},r.bardin_slayer_add_buff_on_leap_start=function(e,t,a){},r.bardin_slayer_remove_buff_on_leap_finished=function(e,t,a){},r.gain_markus_mercenary_passive_proc=function(e,t,a){var n=t.targets,r=getBuff(t.buff_to_add)[0];if(i("markus_mercenary_passive_improved")&&(r=getBuff("markus_mercenary_passive_improved")[0],n=4),a.attack.targets_hit>=n&&(s(e,r,a),i("markus_mercenary_passive_power_level_on_proc"))){var o=getBuff("markus_mercenary_passive_power_level")[0];s(e,o,a)}},r.add_buff_on_first_target_hit=function(e,t,a){},r.add_buff_to_all_players=function(e,t,a){r.add_buff(e,t,a)},r.victor_witchhunter_activated_ability_refund_cooldown_on_enemies_hit=function(e,t,a){},r.remove_victor_bountyhunter_passive_crit_buff=function(e,t,a){},r.victor_bountyhunter_activate_passive_on_melee_kill=function(e,t,a){},r.victor_bounty_hunter_ammo_fraction_gain_out_of_ammo=function(e,t,a){},r},UpdateFuncs=function(){var i={},s=verminted.buffs.buff_funcs;return i.global_buffs=function(){for(var e=function(){for(var e=verminted.buffs.global_buffs.getGlobalBuffs(),t={},a=0;a<e.length;a++)for(var n=getBuff(e[a].name),r=0;r<n.length;r++){var o=n[r];s.addBuff(t,o)}return t}(),t=verminted.build.career.talents,a=0;a<t.length;a++){var n=getCurrentCareerTalent(a);if(n&&n.buffs[0]&&n.buffs[0].update_func){var r=n.buffs[0],o=i[r.update_func](r);o&&s.addBuff(e,o)}}return e},i.bardin_slayer_activate_buff_on_loadout=function(e){var t=verminted.build.items;return!(t[0].name&&getWeaponBuffType(t[0].name)!==e.buff_type||t[1].name&&getWeaponBuffType(t[1].name)!==e.buff_type)&&data.buffs[e.buff_to_add][0]},i.activate_buff_stacks_based_on_ally_proximity=function(e){return!1},i.activate_buff_on_other_buff=function(e){return!1},i.activate_buff_stacks_based_on_clip_size=function(e){return!1},i.activate_buff_stacks_based_on_health_chunks=function(e){return!1},i.bardin_slayer_active_buff_on_charge_action=function(e){return!1},i.activate_buff_stacks_based_on_enemy_proximity=function(e){return!1},i.activate_buff_on_health_percent=function(e){return!1},i},BuffArray=function(){var e={},l=verminted.buffs.buff_funcs,_={},p=[],c=verminted.buffs.trigger_funcs,f={};return e.bind=function(e){f=e},e.getActiveBuffs=function(e,t){for(var a=0;a<p.length;a++){var n=p[a];if(c[n]&&c[n](t))for(var r=_[n],o=0;o<r.length;o++)if(!r[o].weapon_index||r[o].weapon_index===t.attack.weapon_index){var i=r[o].buff,s=i.trigger_func;l[s]&&l[s](e,i,t)}}return e},e.refresh=function(){({}),_={},p=[];var e=f.items,t=f.career.talents||[],a=[];if(f.career.name)for(var n=data.careers[f.career.name].passives,r=0;r<n.length;r++)for(var o=n[r],i=0;i<o.length;i++){if((l=o[i]).trigger)a[d=a.length]={},a[d].buff=l}for(r=0;r<t.length;r++)if("number"==typeof t[r]){var s=data.careers[f.career.name].talent_tree[r][t[r]].buffs;for(i=0;i<s.length;i++){if((l=s[i]).trigger)a[d=a.length]={},a[d].buff=l}}for(r=0;r<e.length;r++){if(e[r].trait.name)if((l=data.item.traits[e[r].trait.name]).trigger)a[d=a.length]={},a[d].buff=l,r<2&&(a[d].weapon_index=r)}for(r=0;r<a.length;r++){var l,c=(l=a[r]).buff.trigger;_[c]=_[c]||[];var d=_[c].length;_[c][d]=l}p=Object.keys(_)},e};function buildDamageArray(e){var t,a=[],n={},r=[];if("undefined"!=typeof Blackboard)var o=Blackboard(e[0].targets[0]);for(var i=verminted.buffs.update_funcs.global_buffs(),s=0,l=0;l<e.length;l++){for(var c=e[l],d=Object.keys(i),_=1,p=0;p<d.length;p++){if("attack_speed"===(v=i[d[p]])[0].stat_buff)for(var f=v.length-1;0<=f&&v[f].end>s;f--)_+=v[f].multiplier}var m=0;0<l&&(m=e[l-1].attack.hit_time),s+=(c.attack.hit_time-m)/_,c.timeline=s,verminted.buffs.buff_array.getActiveBuffs(i,c),d=Object.keys(i);var u={};for(p=0;p<d.length;p++){var v;for(f=(v=i[d[p]]).length-1;0<=f;f--)if(v[f].end>s){var g=v[f].stat_buff||v[f].name;if(u[g]=u[g]||0,v[f].multiplier)u[g]+=v[f].multiplier;else if(v[f].bonus)u[g]+=v[f].bonus;else{if(v[f].stat_buff)break;u[g]=1}}}if(void 0!==c.attack.weapon_index&&(t=c.attack.weapon_index),a[M=a.length]={},a[M].damage=c.damage(t,u),a[M].hit_time=s,a[M].source_type=c.attack.source_type,0<verminted.build.weapon[c.attack.weapon_index].increased_weapon_damage_poisoned_or_bleeding){var h=verminted.build.weapon[c.attack.weapon_index].increased_weapon_damage_poisoned_or_bleeding;if(c.dot)a[M].damage=a[M].damage+a[M].damage*h;else{var b=Object.keys(n);for(f=0;f<b.length;f++)for(p=(y=n[b[f]]).length-1;0<=p;p--){if(y[p].end>s&&y[p].start<s){a[M].damage=a[M].damage+a[M].damage*h,f=255;break}break}}}if(c.dot&&(0<a[M].damage||"bleed"!==c.dot.profile_name)){var k=!0,w=!1;n[c.dot.name]=n[c.dot.name]||[];var y=n[c.dot.name];if(c.dot.max_stacks){w=!0;var C=y.length;C<c.dot.max_stacks?(k=!0,y[C]={},y[C].start=c.timeline,y[C].end=c.timeline+c.dot.duration):y[C-c.dot.max_stacks].end<c.timeline?(k=!0,y[C]={},y[C].start=c.timeline,y[C].end=c.timeline+c.dot.duration):k=!1}if(w){var x=y.length,L=1;k&&(L=2);for(var B=L;B<=c.dot.max_stacks&&(y[x-B]&&y[x-B].end>c.timeline);B++){for(var E=y[x-B].start,N=y[x-B].end,A=c.timeline+c.dot.duration,T=Math.floor((N-E)/c.dot.tick_rate),O=Math.floor((A-E)/c.dot.tick_rate)-T,I=0;I<O;I++){a[M=a.length]={},a[M].damage=j.damage(t,u),a[M].hit_time=y[x-B].start+c.dot.tick_rate*(I+1+T),a[M].source_type=c.dot.source_type}y[x-B].end=A}}if(k)for(B=0;B<c.dot.ticks.length;B++){var M,j=c.dot.ticks[B];a[M=a.length]={},a[M].damage=j.damage(t,u),a[M].hit_time=s+c.dot.tick_rate*(B+1),a[M].source_type=c.dot.source_type}}if(o&&("chaos_warrior"===c.targets[0]||"skaven_storm_vermin"===c.targets[0])){var D=!0,P=r[r.length-1]&&r[r.length-1].stagger||null,W=r[r.length-1]&&r[r.length-1].end||null;if(c.stagger(o,s,t,u),P!==o.stagger||W!==o.stagger_time){var S=r.length;r[S]={},r[S].stagger_start=s,r[S].stagger_end=o.stagger_time,r[S].stagger_duration=o.stagger_time-s}}}return D&&console.log(r),a.sort(function(e,t){return e.hit_time-t.hit_time}),a}function getBreakpoint(e,t){for(var a=0,n=[],r=0,o=0;o<e.length;o++){e[o];a+=.25*Math.round(4*e[o]),n[o]=e[o]/t,r+=n[o]}var i=0,s=0;if(0===a)s=0;else if(t<=a)s=1;else{var l,c,d=[];c=t%a==0?(s=t/a)/(l=t/a-1):(s=Math.ceil(t/a),t/a/(l=Math.floor(t/a)));var _=.25*Math.ceil(t/l*4);for(o=0;o<e.length;o++){d[o]=d[o]||{};n[o];e[o]?d[o].next_bp=.25*Math.round(e[o]*c*4):d[o].next_bp=0}i=c;for(var p=0;;){var f=0,m=[],u=[];for(o=0;o<d.length;o++)if(0<d[o].next_bp){if(f+=d[o].next_bp,d[o].percent=(d[o].next_bp-.125)/e[o],!m[0]||d[o].percent>m[0].percent){for(var v=0;v<m.length;v++)m.pop();m[0]={},m[0].percent=d[o].percent,m[0].index=o}else if(d[o].percent===m[0].percent){m[p=m.length]={},m[p].percent=d[o].percent,m[p].index=o}if(!u[0]||d[o].percent<u[0].percent){var g=u.length;for(v=0;v<g;v++)u.pop();u[0]={},u[0].percent=d[o].percent,u[0].index=o}else if(d[o].percent===u[0].percent){u[p=u.length]={},u[p].percent=d[o].percent,u[p].index=o}}if(100<++p)break;if(_<f){var h=4*f-4*_;if(!(m.length<h)){i=m[0].percent;break}for(o=0;o<m.length;o++){d[b=m[o].index].next_bp=d[b].next_bp-.25}}else{if(f===_){i=m[0].percent;break}if(f<_){if(!u.length)break;for(o=0;o<u.length;o++){var b;d[b=u[o].index].next_bp=d[b].next_bp+.25}}}var k=u.length;for(o=0;o<k;o++)u.pop()}}var w={};return w.ceil=s,w.percent_needed=i,w}var ComboTimeline=function(){var e={},u=document.getElementById("timeline"),v=u.getContext("2d"),g=document.getElementById("timeline-mouse"),h=g.getContext("2d"),b=u.clientHeight,k=u.clientWidth,w=b-20,y=null,C=function(){y&&(y.classList.remove("active-breakpoint"),y=null)};return e.renderTimeline=function(e,t,a){C(),t.classList.add("active-breakpoint"),t.classList.remove("damage-change");for(var n=(y=t).parentNode.getBoundingClientRect(),r=n.left-(k-n.width)/2,o=n.top-b,i=e,s=i[i.length-1].timeline,l=i.length-1;0<=l;l--)if(i[l].dot){var c=i[l].dot.ticks[i[l].dot.ticks.length-1].hit_time;s<c&&(s=c);break}var d=Math.max(s+.3,.8),_=(k-0)/d,p=2,f=.5;switch(Math.floor(d/3)){case 0:p=2,f=.5;break;case 1:f=p=1;break;case 2:p=2/3,f=1.5;break;case 3:default:p=.5,f=2}v.imageSmoothingEnabled=!1,v.clearRect(0,0,k,b),v.fillStyle="#888",v.fillRect(0,0,k,w),function(e,t,a,n){for(var r=0;r<=Math.floor(e*t);r++){var o=r*a,i=Math.floor(0+o*n),s=i-11;0===r&&s--;var l=b-4;v.strokeStyle="#222",v.lineWidth=1,v.beginPath(),v.moveTo(i,0),v.lineTo(i,w),v.stroke(),v.font="18px serif",v.fillText(o.toFixed(1)+"s",s,l)}}(d,p,f,_),function(e,t){for(var a=w/2,n=buildDamageArray(e),r=0;r<n.length;r++){var o=n[r],i=Math.floor(0+o.hit_time*t);switch(o.source_type){case"direct":v.strokeStyle="red";break;case"aoe":v.strokeStyle="yellow",i++,i++;break;case"dot":v.strokeStyle="#0D0";var s=!0}var l=i-(o.hit_time-o.damage_start)*t,c=i-(o.hit_time-o.damage_end)*t;s||(v.lineWidth=1,v.beginPath(),v.moveTo(l,a),v.lineTo(c,a),v.moveTo(l,a-4),v.lineTo(l,4+a),v.moveTo(c,a-4),v.lineTo(c,4+a),v.stroke()),v.lineWidth=2,v.beginPath(),v.moveTo(i,0),v.lineTo(i,w),v.stroke()}}(i,_);var m=data.breeds[a].max_health[verminted.difficulty];v.strokeWidth="4",v.strokeStyle="black",v.strokeRect(0,0,k-0,w),function(e,t){g.style.left=e+"px",g.style.top=t+"px",h.clearRect(0,0,k,b),h.drawImage(u,0,0),g.classList.remove("hide"),g.style.display="inline-block"}(r,o),function(e,_,t,p){var a=g.getBoundingClientRect(),f=a.left,m=(a.top,buildDamageArray(e));g.onmousemove=function(e){h.imageSmoothingEnabled=!1,h.clearRect(0,0,k,b),h.drawImage(u,0,0),e.x>0+f&&(h.strokeStyle="#555",h.beginPath(),h.moveTo(e.offsetX,0),h.lineTo(e.offsetX,w),h.stroke());var t=e.offsetX,a=t,n=e.offsetY;k<a+55&&(a=k-55),n-54<0&&(n=54),h.fillStyle="#999",h.fillRect(a,n,55,-54),h.strokeStyle="#333",h.strokeRect(a,n,55,-54);for(var r=[],o=Math.ceil(t/k*_*100)/100,i=0;i<m.length;i++){var s=m[i];if(!(s.hit_time<o))break;r[i]=s.damage}var l=getBreakpoint(r,p),c=l.ceil,d=Math.ceil(1e3*l.percent_needed)/10||0;0===c&&(c="NA"),0<d&&(d-=100),h.font="18px serif",h.fillStyle="#111",h.fillText(o.toFixed(2)+"s",a+2,n-54+16),h.fillText(c,a+2,n-54+32),h.fillText(d.toFixed(1)+"%",a+2,n-54+48),g.onmouseleave=function(){h.clearRect(0,0,k,b),h.drawImage(u,0,0),g.onmouseleave=null}}}(i,d,0,m),function(){var n=function(e){for(var t=!1,a=e.target;a;){if(a===g){t=!0;break}t=!1,a=a.parentNode}t||(g.style.display="none",C(),document.body.removeEventListener("click",n))};document.body.addEventListener("click",n)}()},e},WeaponBreakpoints=function(M){var j={chain:[]};j.mob_lookup=constants.mob_lookup,j.damage_profiles=[];function x(e){var t=j.chain[e],a=data.weapons[t.weapon].actions[t.action].damage_start+data.weapons[t.weapon].actions[t.action].damage_end;a/=2;var n=t.tts+(a||0);return n/=verminted.build.weapon[t.weapon_index].attack_speed}function y(e,t,a){return function(){return function(e,t,a){var n,r=j.chain[t],o=data.weapons[r.weapon].actions[r.action],i=r.weapon_index,s=data.breeds[a];n=o.hit_mass&&constants.hit_mass[o.hit_mass][a]?s.hit_mass_counts&&s.hit_mass_counts[verminted.difficulty]?constants.hit_mass[o.hit_mass][a]*s.hit_mass_counts[verminted.difficulty]:s.hit_mass_count||99:s.hit_mass_counts&&s.hit_mass_counts[verminted.difficulty]?s.hit_mass_counts[verminted.difficulty]:s.hit_mass_count||99,"es_mercenary"===verminted.build.career.name&&(n*=.75);var l=verminted.damage.getCleave(data.profiles[e],i);return Math.ceil(l/n)}(e,t,a)}}function D(a,n,r,o,i,s,l,c){return i=constants.hit_types[i],function(e,t){return"number"==typeof e&&(r=e),verminted.damage.getDamage(a,n,r,o,i,s,l,c,t)}}function P(r,o,i,s,l,c){return l=constants.hit_types[l],function(e,t,a,n){return"number"==typeof a&&(i=a),verminted.stagger?verminted.stagger.stagger(e,t,r,o,i,s,l,c,n):function(){return 0}}}function W(t,a,n){return function(e){e.stopPropagation(),verminted.timeline.renderTimeline(t,a,n)}}verminted.timeline;j.pullProfiles=function(e,t,a){var n=j.chain[a],r=(j.damage_profiles,data.weapons[e].actions[t]);if(!r)return null;var o=Object.keys(r),i=Object.keys(constants.mob_lookup),s=[];if(r.damage_profile_left&&r.damage_profile_right)s[0]={},s[0].key="damage_profile_left",s[0].value=r.damage_profile_left,s[1]={},s[1].key="damage_profile_right",s[1].value=r.damage_profile_right;else for(var l=0;l<o.length;l++){var c,d=o[l];switch(d){case"damage_profile":case"damage_profile_target":c=r[d],v="direct";break;case"damage_profile_aoe":c=r[d],d="damage_profile_knockback_aoe",v="aoe";break;case"aoe":r[d].damage_profile&&(c=r[d].damage_profile,d="damage_profile_aoe",v="aoe")}if(c){var _=s.length;s[_]={},s[_].key=d,s[_].value=c,s[_].source_type=v}}if(0<s.length){var p={};for(l=0;l<s.length;l++){var f=s[l],m=f.key,u=f.value,v=f.source_type;p[m]={},p[m].profile_name=u,p[m].source_type=v,p[m].max_targets={};for(var g=0;g<i.length;g++){var h=i[g];r.damage_profile_target&&"damage_profile"===m?p[m].max_targets[h]=function(){return verminted.max_targets}:p[m].max_targets[h]=y(u,a,h)}var b=data.profiles[u],k=0;if(b.targets[0]&&b.targets[0].dot||b.default_target.dot){var w;if(w=b.targets[0]&&b.targets[0].dot?b.targets[0].dot:b.default_target.dot,p[m].dot={},p[m].dot.profile_name=w,0===b.targets.length)k=verminted.max_targets;else for(g=0;g<b.targets.length;g++){if(!b.targets[g].dot){k=g;break}}p[m].dot.max_targets=k}}n.damage_profiles=p}},j.getAllDamage=function(){for(var e=j.chain,t=[],a=verminted.max_targets,n=verminted.build.isTalentActive,r=0;r<a;r++){t[r]=[];for(var o=0;o<e.length;o++){var i=e[o],s=i.damage_profiles;if(s){var l=i.weapon_index,c=i.weapon,d=i.action,_=data.weapons[c].actions[d],p=x(o),f=_.damage_start+i.tts,m=_.damage_end+i.tts,u=i.hit_type||4,v=(t[r].length,[]),g=0,h=[];s.damage_profile_target?(v[g]=0===r?s.damage_profile_target:s.damage_profile,g++):s.damage_profile&&s.damage_profile_aoe?(0===r&&(v[g]=s.damage_profile,g++),v[g]=s.damage_profile_aoe,g++):s.damage_profile_left?(h[g]=s.damage_profile_left.max_targets,v[g]=s.damage_profile_left,h[++g]=s.damage_profile_right.max_targets,v[g]=s.damage_profile_right,g++):s.damage_profile&&(h[g]=s.damage_profile.max_targets,v[g]=s.damage_profile,g++);for(var b=0;b<v.length;b++){var k=v[b],w=k.profile_name,y=k.source_type,C={};t[r].length,(C={}).profile_name=w,C.hit_type=u,C.hit_time=p,C.targets_hit=r+1,C.tts=i.tts,C.damage_start=f||i.tts,C.damage_end=m||i.tts,C.source_type=y,C.weapon_index=l,C.weapon_name=c,C.action_name=d,"object"==typeof h[b]&&(C.max_targets=h[b]),data.profiles[w].targets[r]&&data.profiles[w].targets[r].dot?C.dot=data.profiles[w].targets[r].dot:data.profiles[w].default_target&&data.profiles[w].default_target.dot?C.dot=data.profiles[w].default_target.dot:(n("victor_witchhunter_bleed_on_critical_hit")&&("light_attack"===getProfileChargeType(C.profile_name)||"heavy_attack"===getProfileChargeType(C.profile_name))||n("kerillian_waywatcher_critical_bleed")&&"projectile"===getProfileChargeType(C.profile_name))&&(C.dot="weapon_bleed_dot_whc"),t[r][t[r].length]=C}}}}return t},j.buildDamageTicks=function(e,t,a){for(var n=constants.hit_types,r=[],o=(verminted.max_targets,0);o<e.length;o++){r[o]=[];for(var i=0;i<n.length;i++){var s=i;r[o][s]=[];for(var l=0;l<e[o].length;l++){var c=[],d={},_=(T=e[o][l]).weapon_index;if("object"==typeof T.max_targets)if(T.max_targets[t]()<=o)continue;if("string"==typeof T.dot){var p,f=T.weapon_name,m=T.action_name,u=(n[T.hit_type],data.dots[T.dot].dot_type);if("poison_dot"===u&&"neither"===s&&"aoe"!==T.source_type){var v=constants.armor_lookup[data.breeds[t].armor];p=0<(data.profiles[T.profile_name].armor_multiplier&&data.profiles[T.profile_name].armor_multiplier.attack||data.profiles[T.profile_name].armor_multiplier_near&&data.profiles[T.profile_name].armor_multiplier_near.attack)[v]}else p=!0;if(p){var g=(x=data.dots[T.dot]).max_stacks,h=c.length;if(1===x.max_stacks){var b=c[d[u]];if(b&&b.dot_end>T.hit_time){var k=T.hit_time+x.duration;k>b.dot_end&&(b.dot_end=k)}else c[d[u]=h]={},c[h].name=x.name,c[h].profile_name=x.damage_profile,c[h].hit_type=0,c[h].tick_rate=x.tick_rate,c[h].dot_start=T.hit_time,c[h].dot_end=T.hit_time+x.duration,c[h].dot_type=u,c[h].duration=x.duration,c[h].source_type="dot",c[h].weapon_name=f,c[h].action_name=m,c[h].max_stacks=g||0}else c[h]={},c[h].name=x.name,c[h].profile_name=x.damage_profile,c[h].hit_type=0,c[h].tick_rate=x.tick_rate,c[h].dot_start=T.hit_time,c[h].dot_end=T.hit_time+x.duration,c[h].dot_type=u,c[h].duration=x.duration,c[h].source_type="dot",c[h].weapon_name=f,c[h].action_name=m,c[h].max_stacks=g||0}}var w=r[o][s].length;if(r[o][s][w]={},r[o][s][w].targets=[],r[o][s][w].targets[0]=t,r[o][s][w].hit_elite=!!data.breeds[t].elite,r[o][s][w].hit_special=!!data.breeds[t].special,r[o][s][w].mob_armor=constants.armor_lookup[data.breeds[t].armor],r[o][s][w].hit_type=s,r[o][s][w].attack_count=w+1,r[o][s][w].attack=T,r[o][s][w].damage=D(T.weapon_name,T.profile_name,T.weapon_index,t,s,o,T.source_type,{}),r[o][s][w].stagger=P(T.weapon_name,T.profile_name,T.weapon_index,t,s,o),c.length)for(var y=0;y<c.length;y++){var C={source_type:"dot"},x=c[y],L={};L.name=x.name,L.profile_name=x.profile_name,L.hit_type=0,L.tick_rate=x.tick_rate,L.dot_start=x.dot_start,L.dot_end=x.dot_end,L.dot_type=x.dot_type,L.duration=x.duration,L.source_type=x.source_type,L.weapon_name=x.weapon_name,L.action_name=x.action_name,L.max_stacks=x.max_stacks,L.ticks=[];for(var B=x.tick_rate,E=x.dot_end-x.dot_start,N=Math.floor(E/B),A=0;A<N;A++){var T=A,O=x.dot_start+B*(T+1),I=O-.25*B,M=O+.25*B;L.ticks[T]={},L.ticks[T].hit_time=O,L.ticks[T].damage_start=I,L.ticks[T].damage_end=M,L.ticks[T].damage=D(f,x.profile_name,_,t,s,o,x.dot_type,C)}r[o][s][w].dot=L}}}}return r};function c(e,t,a){var n=j.chain,r=constants.hit_types,o=verminted.max_targets,i=verminted.difficulty,s=data.breeds[t].max_health[i];verminted.harder_better&&constants.elites[t]&&(s*=2);for(var l={},c=l=0;c<n.length;c++){var d=n[c].damage_profiles;if(d){var _=0;d.damage_profile_aoe?_=o:d.damage_profile?_=d.damage_profile.max_targets[t]():d.damage_profile_left&&(_=d.damage_profile_left.max_targets>d.damage_profile_right.max_targets?d.damage_profile_left.max_targets[t]():d.damage_profile_right.max_targets[t]()),l<_&&(l=_)}}for(var p=j.buildDamageTicks(e,t),f=0;f<o;f++)for(var m=0;m<r.length;m++){r[m];if(l<=f){for(c=f;c<o;c++)M.breeds[t].targets[c].row.classList.add("hide");break}var u=M.breeds[t].targets[f][r[m]],v=TooltipControl(u),g=t+"\r\n"+r[m],h=M.breeds[t].mob_name,b=t.replace(/_/g," ").replace(/\w+/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1)});h.textContent=b+" ("+s+")";var k=buildDamageArray(p[f][m]);u.onclick=W(p[f][m],u,t);var w=[];for(c=0;c<k.length;c++){var y=c,C=k[y];w[y]=C.damage;var x=Math.round(4*w[y])/4;x,g+="\r\n"+c+" : "+x}var L=getBreakpoint(w,s),B=L.percent_needed,E=L.ceil,N=u.textContent;0===E?u.textContent=0:1===E&0===B?u.textContent=1:(g+="\r\n\r\npower needed for next bp: "+Math.ceil(1e5*(B-1))/1e3,100<(B=Math.ceil(100*B))&&(B-=100),u.textContent=E+" ("+B+"%)");var A=M.breeds[t].targets[f].row;if(u.textContent!==N)u.classList.remove("damage-change"),a[a.length]=u;else if(A.classList.contains("hide"))for(var T=0;T<A.children.length;T++){var O=A.children[T];O.classList.remove("damage-change"),window.setTimeout(function(){O.classList.add("damage-change")},0)}v.text(g),A.classList.remove("hide")}var I=M.breeds[t].extra_targets;o<l?(I.textContent="+"+(l-o),I.classList.remove("hide")):I.classList.add("hide")}return j.buildBreakpoints=function(e,t){if(!(e<0)){j.chain,j.damage_profiles,constants.hit_types,verminted.difficulty;for(var a=M.container,n=Object.keys(constants.mob_lookup),r=[],o=(verminted.max_targets,j.getAllDamage()),i=0,s=n.length;i<s;i++){var l=n[i];c(o,l,r)}window.setTimeout(function(){for(var e=0;e<r.length;e++)r[e].classList.add("damage-change")},0),a.classList.remove("hide")}},j.clearAttacks=function(){for(var e=0,t=chain.length;e<t;e++)chain.pop()},j.generateCombo=function(){for(var e=0,t=chain.length;e<t;e++);},j},AttackBreakpoints=function(e,t){var r=e.container,o=WeaponBreakpoints(e),a=r.parentNode,n=a.getElementsByClassName("weapon-breakpoints-attacks")[0],s={attacks:[]};s.name_div=e.name_div,o.chain[0]={},o.chain[0].weapon_index=t,o.chain[0].tts=0;var i=function(e){var t=e.target.getAttribute("data-action");o.chain[0].action=t;o.pullProfiles(s.name,t,0),o.buildBreakpoints(0,"raw");for(var a=0;a<s.attacks.length;a++){var n=s.attacks[a];n!==e.target?n.classList.add("not-active-talent"):n.classList.remove("not-active-talent")}r.classList.remove("hide")};return o.set=function(e){o.chain[0].weapon=e,s.name=e,s.name_div.textContent=e,a.classList.remove("hide"),function(){for(var e=data.weapons[s.name].actions,t=Object.keys(e).sort(),a=[],n=0,r=0;r<t.length;r++){var o=e[t[r]];(o.damage_profile||o.damage_profile_left)&&(a[n]=t[r],n++)}for(r=0;r<s.attacks.length;r++){var i=s.attacks[r];a[r]?(i.textContent=a[r],i.setAttribute("data-action",a[r]),i.classList.remove("hide"),i.classList.remove("not-active-talent")):i.classList.add("hide")}}()},o.refresh=function(){var e=o.chain[0];s.name&&e.action&&data.weapons[e.weapon].actions[e.action]&&o.buildBreakpoints(0)},verminted.update_on_build[verminted.update_on_build.length]=o.refresh,function(){for(var e=0;e<10;e++){var t=document.createElement("div");t.classList.add("weapon-attack"),t.classList.add("js-button"),t.classList.add("hide"),t.addEventListener("click",i),s.attacks[e]=t,n.appendChild(t)}}(),o};function reverseLookup(l){if(data.weapons[l].lookup)return!1;var c={},d=data.weapons[l].actions,_=Object.keys(d),p={lookup:{}};p.lookup.default=!0,p.current=0,p.buffer=[],p.buffer[0]="default",p.future=p.current+1;var f=function(e){c[e]={};for(var t=0,a=_.length;t<a;t++){var n=d[_[t]];if(n.attack_speed&&n.attack_speed.parent)for(var r=Object.keys(n.attack_speed.parent),o=0,i=r.length;o<i;o++)p.lookup[r[o]]||(p.lookup[r[o]]=!0,p.buffer[p.future]=r[o],p.future++),e===r[o]&&(c[e][_[t]]=n.attack_speed.parent[r[o]]);if(n.attack_speed.child){var s=Object.keys(n.attack_speed.child);for(o=0,i=s.length;o<i;o++)p.lookup[s[o]]||(p.lookup[s[o]]=!0,p.buffer[p.future]=s[o],p.future++)}}p.current++,p.buffer[p.current]?(e=p.buffer[p.current],f(e)):data.weapons[l].block&&(c.block=c.block||{},c.block.push=data.weapons[l].block.min_hold,data.weapons[l].push&&(c.push=c.push||{}),c.block_cancel_end&&delete c.block_cancel_end,c.anim_cancel&&delete c.anim_cancel)};return f(p.buffer[0]),data.weapons[l].lookup=c,!0}var AttackChain=function(c){var w={anim_cancel:.05,weapon:[]},y={};w.chain=[];var e=document.getElementById("TEMPLATE-CHAIN");if(e.content)var d=e.content.firstElementChild;else d=document.getElementById("TEMPLATE-CHAIN").querySelectorAll(".chain-attack-select")[0];function _(e,t){w.chain;for(var a=[],n=0,r=0,o=w.weapon.length;r<o;r++){var i=w.weapon[r],s=data.weapons[i];if(i&&"melee"===data.weapons[i].type){if(t&&t.weapon===w.weapon[r]&&data.weapons[t.weapon].actions[t.attack]&&t.weapon_index===r){for(var l=data.weapons[t.weapon].actions,c=l[t.attack].attack_speed,d=Object.keys(c).sort(),_=[],p={},f=0;f<d.length;f++){if(l[m=d[f]]&&(l[m].damage_profile||l[m].damage_profile_left))p[_[_.length]=m]=!0}for(f=0;f<d.length;f++){var m;if(!p[m=d[f]])_[_.length]=m}f=0;for(var u=(d=_).length;f<u;f++)"block_cancel_end"!==d[f]&&(a[n]={},a[n].name=r+1+" "+d[f],a[n].attack=d[f],a[n].weapon=i,a[n].weapon_index=r,n++)}else for(var v=data.weapons[i].actions.neutral.attack_speed,g=0,h=(k=Object.keys(v)).length;g<h;g++)a[n]={},a[n].name=r+1+" "+k[g],a[n].attack=k[g],a[n].weapon=i,a[n].weapon_index=r,n++;var b=Object.keys(y[i].push);y[i].block.push;y[i].push[b[0]],a[n]={},a[n].name=r+1+" push_attack",a[n].attack=s.actions.push.push_attack,a[n].weapon=i,a[n].weapon_index=r,n++}else if(i&&"ranged"===data.weapons[i].type)if(t&&t.weapon===w.weapon[r]&&"neutral"!==t.attack){s.actions[t.attack]?c=s.actions[t.attack].attack_speed:(c=s.actions.neutral.attack_speed,"block"===t.attack?s.block.min_hold:"anim_cancel"===t.attack&&w.anim_cancel);for(f=0,u=(d=Object.keys(c)).length;f<u;f++)"block_cancel_end"!==d[f]&&(a[n]={},a[n].name=r+1+" "+d[f],a[n].attack=d[f],a[n].weapon=i,a[n].weapon_index=r,n++)}else{var k;for(v=data.weapons[i].actions.neutral.attack_speed,g=0,h=(k=Object.keys(v)).length;g<h;g++)a[n]={},a[n].name=r+1+" "+k[g],a[n].attack=k[g],a[n].weapon=i,a[n].weapon_index=r,n++}}for(f=0,u=a.length;f<u;f++)a[f].node=document.createElement("option"),a[f].node.value=a[f].weapon+","+a[f].attack+","+a[f].weapon_index,a[f].node.textContent=a[f].name,e.appendChild(a[f].node);return a}var p=verminted.combo_breakpoints,f=function(e){var t,a=w.chain;if(e.target)t=e.target;else{if(!e.value)throw"next chain had a problem";t=e}var n=t.value.split(/,/),r={};r.weapon=n[0],r.attack=n[1],r.weapon_index=parseInt(n[2],10);var o=parseInt(t.getAttribute("data-count"),10)||0,i=o+1;if(a[i])for(var s=a.length-1,l=i;l<=s;s--)c.removeChild(a[s].node),a.pop();a[i-1].weapon=n[0],a[i-1].action=n[1],a[i]={},a[i].node=c.appendChild(d.cloneNode(!0)),a[i].node.classList.remove("hide"),a[i].select=a[i].node.getElementsByClassName("chain-attack-dropdown")[0],a[i].select.setAttribute("data-count",i),_(a[i].select,r),a[i].select.addEventListener("change",f),p.addAttack(r.weapon,r.attack,r.weapon_index,o)};return w.refresh=function(){for(var e=w.chain,t=!1,a=null,n=0,r=e.length;n<r;n++){var o=e[n].select.value.split(/,/)[0];o!==w.weapon[0]&&o!==w.weapon[1]&&(t=!0),t&&(null===a&&(a=n-1),c.removeChild(e[n].node))}for(n=e.length-1,r=0;r<=n;n--)e[n].node.parentNode&&c.removeChild(e[n].node),e.pop();e[0]&&c.removeChild(e[0].node),e[0]=e[0]||{},e[0].node=c.appendChild(d.cloneNode(!0)),e[0].node.classList.remove("hide"),e[0].select=e[0].node.getElementsByClassName("chain-attack-dropdown")[0],e[0].select.setAttribute("data-count",0),_(e[0].select),e[0].select.addEventListener("change",f)},w.setWeapon=function(e,t){reverseLookup(w.weapon[t]=e),y[e]=data.weapons[e].lookup,w.refresh()},w},ComboBreakpoints=function(y){var C=WeaponBreakpoints(y);C.headshot_chance=0,C.armor_types=constants.armor_types;var x=C.buildBreakpoints,e=document.getElementsByClassName("chain-options-modal")[0],t=(e.getElementsByClassName("chain-attack-options")[0],e.parentNode.parentNode),a=ModalControl(t,e);a.close=function(){verminted.build.refresh(),t.classList.add("hide"),document.body.removeEventListener("click",a.onClick),document.body.classList.remove("no-scroll")};for(var n=document.getElementsByClassName("chain-attack-header"),r=0,o=n.length;r<o;r++)n[r].addEventListener("click",function(e){a.open(),e.stopPropagation()});document.getElementsByClassName("chain-options-modal-close")[0].addEventListener("click",a.close);function m(e){C.chain,C.damage_profiles;for(var t=C.armor_types,a=y.info.damage_box,n=(y.info.damage_box.dps,["skaven_slave","skaven_storm_vermin","skaven_pack_master","","skaven_plague_monk","chaos_warrior"]),r=0;r<t.length;r++){3===r&&(r=4);var o=t[r];if(a.dps[o])var i=a.dps[o];else(i=document.createElement("div")).classList.add(C.armor_types[r]),a.dps[C.armor_types[r]]=i,a.container.appendChild(a.dps[C.armor_types[r]]);var s=TooltipControl(i),l=0;if(0<e){var c,d,_=C.getAllDamage(),p=C.buildDamageTicks(_,n[r]),f=C.headshot_chance,m=verminted.build.weapon[0].crit_chance||.05,u=0,v=0,g=0,h=0,b=[];if(0<(d=1-((f-=c=f*m)+(m-=c)+c))){b=buildDamageArray(p[0][0]);for(var k=0;k<b.length;k++)u+=b[k].damage}if(0<f){b=buildDamageArray(p[0][1]);for(k=0;k<b.length;k++)v+=b[k].damage}if(0<m){b=buildDamageArray(p[0][2]);for(k=0;k<b.length;k++)g+=b[k].damage}if(0<c){b=buildDamageArray(p[0][3]);for(k=0;k<b.length;k++)h+=b[k].damage}var w="DPS against "+o+"\r\n"+(l=((u*=d)+(v*=f)+(g*=m)+(h*=c))/e).toFixed(2);s.text(w),i.textContent=Math.floor(10*l)/10}else i.textContent=0}}function L(){var e=C.chain,t=y.info.attack_speed,a=0,n=!1;if(1<e.length){var r=e.length-1,o=data.weapons[e[r].weapon],i=e[r].weapon_index,s=verminted.build.weapon[i].attack_speed||1;if(e[r].weapon===e[0].weapon)if(o.actions[e[r].action]&&o.actions[e[r].action].attack_speed[e[0].action]){var l=o.actions[e[r].action].timeout,c=o.actions[e[r].action].attack_speed[e[0].action]-o.actions.neutral.attack_speed[e[0].action];a+=l&&l<c?l:c/s,n=!0}else if(i!==e[0].weapon_index){l=o.actions[e[r].action].timeout,c=o.actions[e[r].action].attack_speed.anim_cancel-o.actions.neutral.attack_speed[e[0].action];a+=l&&l<c?l:c/s,n=!0}else if(o.actions.push&&e[0].action===o.actions.push.push_attack){switch(e[r].action){case"anim_cancel":case"block":a+=0;break;default:var d=o.actions[e[r].action].attack_speed.block,_=o.actions[e[r].action].damage_start+o.actions[e[r].action].damage_end;a+=d<(_/=2)?_/s:d/s}n=!0}else"anim_cancel"===e[r].action?(a+=verminted.anim_cancel,n=!0):"block"===e[r].action&&(n=!0);else a+=o.actions[e[r].action].attack_speed.anim_cancel/s,a+=verminted.anim_cancel,n=!0}for(var p=0,f=e.length;p<f;p++){i=e[p].weapon_index,c=verminted.build.weapon[i].attack_speed||1;data.weapons[e[p].weapon].actions[e[p].action]&&data.weapons[e[p].weapon].actions[e[p].action].timeout&&data.weapons[e[p].weapon].actions[e[p].action].timeout<e[p].speed*c?a+=data.weapons[e[p].weapon].actions[e[p].action].timeout:a+=e[p].speed/c}a=Math.ceil(100*a)/100,t.textContent=a+"s",n&&"number"==typeof a?(t.style.color="black",m(a)):(t.style.color="red",m(0))}var B=e.getElementsByClassName("chain-attack-options")[0],i=!(C.addAttack=function(e,t,a,n){var r=C.chain,o=C.damage_profiles;if(0===n&&({},E(!0)),n<r.length){for(var i=r[n].profile_length-1,s=o.length;i<s;s--)o[s]=null,o.pop();for(s=r.length-1;n-1<s;s--)B.removeChild(r[s].options.div),r[s]=null,r.pop()}r[n]={},r[n].weapon=e,r[n].weapon_index=a,r[n].action=t,r[n].speed=0,r[n].hit_type=4,r[n].profile_length=o.length,r[n].options={};var l=document.createElement("div");l.classList.add("attack-options");var c=document.createElement("div");c.classList.add("attack-count"),c.textContent=n+1;var d=document.createElement("div");d.classList.add("attack-name-options");var _=document.createElement("p");_.textContent=e;var p=document.createElement("span");p.textContent=t,d.appendChild(_),d.appendChild(p);var f=document.createElement("select");f.classList.add("attack-option-select"),f.classList.add("js-input"),f.addEventListener("change",function(){r[n].hit_type=parseInt(f.value)});var m=document.createElement("option");m.value=4,m.textContent="default",m.setAttribute("selected",!0),f.appendChild(m);for(s=0;s<constants.hit_types.length;s++){var u=document.createElement("option");u.value=s,u.textContent=constants.hit_types[s],f.appendChild(u)}l.appendChild(c),l.appendChild(d),l.appendChild(f),B.appendChild(l),r[n].options.div=l;var v=n;if(C.pullProfiles(e,t,n),data.weapons[e].actions[t]){if("melee"===(g=data.weapons[e]).type&&t===g.actions.push.push_attack){if(r[n].speed=g.actions.push.attack_speed[t],r[n].speed+=g.block.min_hold,0<n)if(e===r[n-1].weapon){b=0,k=0;data.weapons[r[n-1].weapon].actions[r[n-1].action]&&(b=data.weapons[r[n-1].weapon].actions[r[n-1].action].attack_speed.block,k=data.weapons[r[n-1].weapon].actions[r[n-1].action].damage_start,k+=data.weapons[r[n-1].weapon].actions[r[n-1].action].damage_end,k/=2),r[n].speed+=b<k?k:b}else{w=data.weapons[r[n-1].weapon].actions[r[n-1].action].attack_speed.anim_cancel,k=data.weapons[r[n-1].weapon].actions[r[n-1].action].damage_start;k+=data.weapons[r[n-1].weapon].actions[r[n-1].action].damage_end,k/=2,r[n].speed+=w<k?k:w}}else 0===n?r[n].speed=g.actions.neutral.attack_speed[t]:data.weapons[r[n-1].weapon].actions[r[n-1].action]?r[n].weapon_index!==r[n-1].weapon_index?(r[n].speed=g.actions.neutral.attack_speed[t],r[n].speed+=data.weapons[r[n-1].weapon].actions[r[n-1].action].attack_speed.anim_cancel):r[n].speed=g.actions[r[n-1].action].attack_speed[t]:r[n].speed=g.actions.neutral.attack_speed[t]}else{var g,h=n-1;(g=data.weapons[r[h].weapon]).actions[r[h].action];if("block"===t){var b=data.weapons[r[n-1].weapon].actions[r[n-1].action].attack_speed.block,k=data.weapons[r[n-1].weapon].actions[r[n-1].action].damage_start;k+=data.weapons[r[n-1].weapon].actions[r[n-1].action].damage_end,k/=2,r[n].speed+=b<k?k:b,r[n].speed+=g.block.min_hold}else{var w=data.weapons[r[n-1].weapon].actions[r[n-1].action].attack_speed.anim_cancel,k=data.weapons[r[n-1].weapon].actions[r[n-1].action].damage_start;k=data.weapons[r[n-1].weapon].actions[r[n-1].action].damage_end,k/=2,r[n].speed+=w<k?k:w}v-=1}for(s=r[n].tts=0;s<=n;s++)r[n].tts+=r[s].speed;x(v),L()}),E=function(e){(i=e||!i)?(y.container.getElementsByClassName("breakpoint-plate")[0].classList.remove("hide"),y.info.container.classList.remove("hide")):(y.container.getElementsByClassName("breakpoint-plate")[0].classList.add("hide"),y.info.container.classList.add("hide"))};return C.refresh=function(){var e=C.chain;e[0]&&null!==verminted.build.getWeaponIndex(e[0].weapon)&&L(),x(e.length-1)},y.container.getElementsByClassName("attack-combo-title")[0].addEventListener("click",function(){E()}),verminted.update_on_build[verminted.update_on_build.length]=C.refresh,C},TooltipControl=function(t){if(verminted.tooltips[uniqueID(t)])return verminted.tooltips[uniqueID(t)];var e={},a=null,n=verminted.tooltip,r=n.children[0],o="pre",i=null;return e.open=function(){var e=t.getBoundingClientRect();r.textContent=i,r.style.whiteSpace=o,n.style.display="inline-block",e.right+n.offsetWidth+2>window.innerWidth?n.style.left=window.innerWidth-(n.offsetWidth+2)+"px":n.style.left=e.right-0+"px",n.style.top=e.bottom+"px"},e.close=function(){n&&(n.style.display="none"),clearTimeout(a)},e.bind=function(){t.addEventListener("mouseover",e.startTimer),t.addEventListener("mouseout",e.close)},e.startTimer=function(){a=setTimeout(function(){e.open()},400)},e.text=function(e,t){o="generated"===t?"normal":"pre",i=e},e.bind(),verminted.tooltips[uniqueID(t)]=e},ModalControl=function(r,o){var i={clickCallback:null,closeCallback:null};i.modal=r;var t=!0;return i.open=function(){r.classList.remove("hide"),i.bind();var e=r.children[0];t?t=!1:e.scrollTo&&e.scrollTo(0,0),document.body.classList.add("no-scroll")},i.setClickCallback=function(e){i.clickCallback=e},i.setCloseCallback=function(e){i.closeCallback=e},i.close=function(){null!==i.closeCallback&&i.closeCallback(),r.classList.add("hide"),document.body.removeEventListener("click",i.onClick),document.body.classList.remove("no-scroll")},i.onClick=function(e){e.stopPropagation();var t=e.target,a=!1;if(o)var n=o;else n=r;for(;t&&t.classList;){if(t===n||t.classList.contains("weapon-list-holder")){a=!1;break}if(t===document.body){a=!0;break}t=t.parentNode}a&&i.close()},i.bind=function(){document.body.addEventListener("click",i.onClick)},i},BuildBuild=function(){var m=document.getElementsByClassName("build-modal")[0].parentNode.parentNode,C={career:{}};C.career.name,C.career.multipliers={},C.career.talents=[],C.items=[],C.weapon=[],C.weapon_lookup={},C.update_on_close=verminted.update_on_build;var x={};x.container=document.getElementsByClassName("weapon-list")[0],x.modal=verminted.weapon_list,x.lookup={},x.weapon={},x.property_combos={};document.getElementsByClassName("buff-container")[0],document.getElementsByClassName("weapon-breakpoints-container");for(var s,L={},k={},i=[],w=[],y=[],e=0;e<data.careers.bw_scholar.talent_tree.length;e++)y[e]={};var u={power_level_unarmoured:"infantry",power_level_armoured:"armored",power_level_large:"monster",power_level_frenzy:"berserker",power_level_skaven:"skaven",power_level_chaos:"chaos",power_level:"power"},l=verminted.compression;C.modal=ModalControl(m,document.getElementsByClassName("build-modal")[0]),document.getElementsByClassName("build-modal-close")[0].addEventListener("click",C.modal.close);function B(t,e){var a=e.id,n=e.fallback;localizeText(a,e.key,function(e){e=e||n,t.textContent=e})}function c(e){var t=e.target.getAttribute("data-item-slot"),a=e.target.getAttribute("data-property-slot"),n=e.target.value;o(n,t,a)}function d(a){return function(e){var t=e.target.value;a.name=t;data.item.traits[t];I.refresh()}}function _(e,t){return function(){r(e,t)}}function E(e){var t,a,n=C.items;a=C.career.name?(t=data.careers[C.career.name]).equipment:data.careers.dr_ranger.equipment;for(var r=0,o=n.length;r<o;r++){var i,s=a[r];if("dr_slayer"===C.career.name&&"throwing_axes"===n[r].name&&(s="ranged"),i=data.weapons[n[r].name]?data.weapons[n[r].name].traits:1===r?"ranged_ammo":a[r],L[t]);else{if(n[r].type===s&&n[r].trait_type===i&&!e)continue;n[r].type=s,n[r].trait_type=i;for(var l=0,c=n[r].property.length;l<c;l++){for(var d=0,_=n[r].property[l].options.length;d<_;d++){var p=n[r].property[l].options.length-1;n[r].property[l].select.removeChild(n[r].property[l].options[p]),n[r].property[l].options.pop()}var f=s;"ranged_ammo"!==f&&"ranged_heat"!==f||(f="ranged");var m=document.createDocumentFragment(),u=Object.keys(x.property_combos[f]).sort(),v=!1;for(d=0,_=u.length;d<_;d++){var g=u[d],h=((w=document.createElement("option")).value=g)+r+l;B(w,{id:data.item.properties[g].name,fallback:g,key:h}),n[r].property[l].name&&g===n[r].property[l].name&&(w.setAttribute("selected",!0),v=!0),n[r].property[l].options[d]=w,m.appendChild(w)}!v&&n[r].property[l].name&&(n[r].property[l].name=u[0]),n[r].property[l].select.appendChild(m)}if(-1<r){var b=n[r].trait.options.length;if(0<b)for(l=0;l<b;l++){p=b-1-l;n[r].trait.select.removeChild(n[r].trait.options[p]),n[r].trait.options.pop()}m=document.createDocumentFragment();var k=data.item.trait_combos[i].sort();for(v=!1,l=0,c=data.item.trait_combos[i].length;l<c;l++){var w,y=k[l];h=((w=document.createElement("option")).value=y)+r;B(w,{id:data.item.traits[y].name,fallback:y,key:h}),n[r].trait.name&&y===n[r].trait.name&&(w.setAttribute("selected",!0),v=!0),n[r].trait.options[l]=w,m.appendChild(w)}!v&&n[r].trait.name&&(n[r].trait.name=k[0]),n[r].trait.select.appendChild(m)}}}}function N(t,e){var a=e.id,n=e.fallback;localizeText(a,e.key,function(e){e?t.text(e,"generated"):t.text(n)})}var p=function(e,t){if(k={},C.career.name&&!t){var a=C.items,n={};n.career=C.career.name,n.items=[];for(var r=0;r<5;r++)n.items[r]={},r<2&&(n.items[r].weapon=a[r].name),n.items[r].properties={},n.items[r].properties[0]=a[r].property[0].name,n.items[r].properties[1]=a[r].property[1].name,n.items[r].trait=a[r].trait.name;n.talents=[];for(r=0;r<y.length;r++)n.talents[r]=y[r].col;L[C.career.name]=n}C.career.name=e,C.career.crit_chance=data.careers[e].base_crit_chance,C.career.attack_speed=data.careers[e].base_attack_speed||0,C.career.reload_speed=data.careers[e].base_reload_speed||0,C.career.headshot_multiplier=data.careers[e].base_headshot_multiplier||0,C.career.backstab_multiplier=data.careers[e].base_backstab_multiplier||0,E();var o=data.careers[e].talent_tree;if(L[e]&&!t)O(L[e]);else for(var i=0;i<o.length;i++){var s=i;y[s]={};for(var l=0;l<o[s].length;l++){var c,d=l,_=o[s][d],p=void 0;if(!p&&_.buffs){p="";for(r=0;r<_.buffs.length;r++){0<r&&(p+="\r\n");var f=_.buffs[r];p+=f.name+"\r\n",f.stat_buff&&(p+="property: "+f.stat_buff+"\r\n"),(f.bonus||f.multiplier)&&(p+="bonus: "+(f.bonus||f.multiplier)+"\r\n"),f.max_stacks&&(p+="max stacks: "+f.max_stacks+"\r\n")}}c=_.buffs[0]&&_.buffs[0].name?_.buffs[0].name.replace(/_/g," "):s+"-"+d,w[s][d].div.classList.remove("not-active-talent");var m=w[s][d].div,u=TooltipControl(w[s][d].div),v=c,g=p,h="talentdesc"+s+d,b="talentname"+s+d;N(u,{id:_.description,fallback:g,key:h}),B(m,{id:_.name,fallback:v,key:b})}}I.refresh(),T()},r=function(e,t){var a=C.career.name;if(a){var n=data.careers[a].talent_tree;y[e]=n[e][t],y[e].col=t,C.career.talents[e]=t;var r=y[e];i[e]&&(k[i[e]]=null),k[r.talent_name]=!0,i[e]=r.talent_name;for(var o=0;o<n[e].length;o++)o!==t?w[e][o].div.classList.add("not-active-talent"):w[e][o].div.classList.remove("not-active-talent");I.refresh()}};C.isTalentActive=function(e){return!!k[e]};function v(t){return function(e){e.stopPropagation(),e.target.checked?verminted.buffs.global_buffs.setGlobalBuff(t,1):verminted.buffs.global_buffs.setGlobalBuff(t,0)}}function g(a,n){return function(e){e.stopPropagation();var t=e.target.valueAsNumber;n<t?verminted.buffs.global_buffs.setGlobalBuff(a,n):t<0?verminted.buffs.global_buffs.setGlobalBuff(a,0):verminted.buffs.global_buffs.setGlobalBuff(a,t)}}function h(e){var t=0;if(data.careers[C.career.name])if(u[e]){for(var a=0;a<y.length;a++)if(y[a].buffs)for(var n=0;n<y[a].buffs.length;n++){e!==(r=y[a].buffs[n]).stat_buff||r.max_stacks||(t+=r.multiplier)}}else{t+=C.career[e]||0;for(a=0;a<y.length;a++)if(y[a].buffs)for(n=0;n<y[a].buffs.length;n++){var r;e!==(r=y[a].buffs[n]).stat_buff||r.max_stacks||("crit_chance"===r.stat_buff?t+=r.bonus:t+=r.multiplier)}}else"crit_chance"===e&&(t+=.05);return t}var b=function(e,t,a){var n=C.items;n[t].name=e,verminted.weapon_attack_breakpoints[t].set(e),n[t].weapon.div.textContent=e,E(),verminted.attack_chain.setWeapon(e,t)},o=function(e,t,a){var n=C.items;n[t].property[a].name=e,n[t].property[a].value=data.item.properties[e].value[1],function(e){var t=C.items,a=[];a[0]=t[e].property[0].select.value,a[1]=t[e].property[1].select.value;for(var n=t[e].type,r=x.property_combos[n],o=0,i=t[e].property.length;o<i;o++)for(var s=0,l=t[e].property[o].options.length;s<l;s++){var c=t[e].property[o].options[s].value;r&&r[a[(o+1)%2]]?r[a[(o+1)%2]][c]?t[e].property[o].options[s].removeAttribute("disabled"):t[e].property[o].options[s].setAttribute("disabled",!0):t[e].property[o].options[s].removeAttribute("disabled")}}(t)},A=[],T=function(){for(var e=verminted.buffs.global_buffs.getGlobalBuffs("list"),t=m.getElementsByClassName("buff-container")[0],a=0;a<A.length;a++)t.removeChild(A[a]);A=[];for(a=0;a<e.length;a++){var n=e[a],r=n.name,o=n.stacks,i=n.buff[0].max_stacks,s=document.createElement("label"),l=document.createElement("div");l.classList.add("buff");for(var c=TooltipControl(l),d="",_=0;_<n.buff.length;_++){n.buff[_].name;0<_&&(d+="\r\n"),d+=r+"\r\n"+(n.buff[_].stat_buff||n.buff[_].name)+"\r\n"+(n.buff[_].multiplier||n.buff[_].bonus||1)}c.text(d);var p=document.createElement("div");p.classList.add("buff-name"),p.textContent=r;var f=document.createElement("input");i<=1?(f.type="checkbox",f.classList.add("buff-toggle"),f.checked=o,l.addEventListener("click",v(r))):1<i&&(f.type="number",f.max=i,f.min=0,f.value=o,f.classList.add("buff-input"),f.addEventListener("change",g(r,i))),l.appendChild(p),l.appendChild(f),n.div=l,n.source_div=p,(n.label=s).appendChild(l),A[A.length]=s,t.appendChild(s)}};C.getMultipliers=function(e){for(var t=C.items,a=C.weapon,n=C.weapon_lookup,r=[],o=0,i=t.length;o<i;o++){if("charm"===t[o].type||"trinket"===t[o].type)r[r.length]=t[o]}for(o=0;o<n.length;o++)n.pop();for(o=0,i=t.length;o<i;o++){var s=t[o].name;if(a[o]={},s||data.weapons[t[o].name]){a[n[s]=o].name=s,a[o].multipliers={},a[o].attack_speed=1+h("attack_speed"),a[o].reload_speed=1+h("reload_speed"),a[o].crit_boost=h("crit_boost"),a[o].power_boost=h("power_boost"),a[o].crit_chance=h("crit_chance"),a[o].headshot_multiplier=h("headshot_multiplier"),a[o].backstab_multiplier=h("backstab_multiplier"),a[o].increased_weapon_damage_poisoned_or_bleeding=h("increased_weapon_damage_poisoned_or_bleeding"),a[o].has_power_boost=h("has_power_boost"),a[o].increased_burn_damage=h("increased_burn_damage"),a[o].reduced_non_burn_damage=h("reduced_non_burn_damage"),a[o].reduced_overcharge=h("reduced_overcharge"),a[o].power_level_ranged_drakefire=h("power_level_ranged_drakefire"),a[o].power_level_melee=h("power_level_melee"),a[o].power_level_melee_cleave=h("power_level_melee_cleave");for(var l=Object.keys(u),c=0,d=l.length;c<d;c++)a[o].multipliers[l[c]]=h(l[c]);data.weapons[s].type;a[o].multipliers.increased_weapon_damage=h("increased_weapon_damage"),a[o].multipliers.power_level_melee=h("power_level_melee"),a[o].multipliers.increased_weapon_damage_melee=h("increased_weapon_damage_melee"),a[o].multipliers.power_level_ranged=h("power_level_ranged"),a[o].multipliers.increased_weapon_damage_ranged=h("increased_weapon_damage_ranged"),a[o].multipliers.damage_taken=h("damage_taken");for(c=0,d=r.length+1;c<d;c++)for(var _,p=0,f=(_=r[c]?r[c].property:t[o].property).length;p<f;p++){var m=_[p];u[m.name]?a[o].multipliers[m.name]+=m.value:"attack_speed"===m.name?a[o].attack_speed+=m.value:"crit_boost"===m.name?a[o].crit_boost+=m.value:"crit_chance"===m.name&&(a[o].crit_chance+=m.value)}}}return a},C.getWeaponIndex=function(e){C.items,C.weapon;var t=C.weapon_lookup;return 0<=t[e]||C.getMultipliers(),t[e]},C.refresh=function(){C.weapon;T(),C.getMultipliers();for(var e=0,t=verminted.update_on_build.length;e<t;e++)verminted.update_on_build[e]()};C.encode=function(e){var t={};if(t.career=C.career,t.talents=y,t.items=C.items,t.career&&t.career.name){e.classList.remove("failed-copy");var a=l.encode(t),n="?"+a;e.textContent=n;var r=verminted.link+n,o=document.createElement("textarea");o.classList="hide",o.value=r,e.appendChild(o),o.focus(),o.select(),document.execCommand("copy"),e.removeChild(o);var i=document.createRange();i.selectNodeContents(e);var s=window.getSelection();s.removeAllRanges(),s.addRange(i),a!==C.build_code&&(history.pushState({build:{build_code:a}},"",n),C.build_code=a)}else e.classList.add("failed-copy")},C.decode=function(e){var t=verminted.compression.decode(e);O(t),C.build_code=e};var t,O=function(e){if(p(e.career,!0),e.items){e.items[0]&&e.items[0].weapon&&b(e.items[0].weapon,0),e.items[1]&&e.items[1].weapon&&b(e.items[1].weapon,1);for(var t=0;t<e.items.length;t++)e.items[t]&&e.items[t].properties&&(e.items[t].properties[0]&&o(e.items[t].properties[0],t,0),e.items[t].properties[1]&&o(e.items[t].properties[1],t,1)),e.items[t]&&e.items[t].trait&&(C.items[t].trait.name=e.items[t].trait)}if(e.talents)for(t=0;t<e.talents.length;t++)if("number"==typeof e.talents[t]){var a=t,n=e.talents[t];r(a,n)}!function(){for(var e=0;e<s.length;e++){var t=s[e];t.value===C.career.name?t.setAttribute("selected",!0):t.removeAttribute("selected",!1)}E()}(),E(!0)},I=verminted.buffs.buff_array;return I.bind(C),C.test=I,C.modal.setCloseCallback(C.refresh),function(){verminted.update_weapon[verminted.update_weapon.length]=b;for(var e=x.container,t=Object.keys(data.weapons).sort(),a=document.createDocumentFragment(),n=0,r=t.length;n<r;n++){for(var o=t[n],i=data.weapons[o].type,s=Object.keys(data.weapons[o].career),l=0,c=s.length;l<c;l++){var d=s[l],_=i;"dr_slayer"===d&&"throwing_axes"===o&&(_="melee"),x.lookup[d]=x.lookup[d]||{},x.lookup[d][_]=x.lookup[d][_]||[];var p=x.lookup[d][_].length;x.lookup[d][_][p]=o}var f=document.createElement("div");f.classList.add("weapon-list-weapon-name"),f.classList.add("js-button"),f.setAttribute("data-weapon",o),f.textContent=o,x.weapon[o]={},x.weapon[o].div=f,a.appendChild(f)}e.appendChild(a)}(),function(){for(var e=m.getElementsByClassName("select-career")[0],t=document.createDocumentFragment(),a=Object.keys(data.careers).sort(),n=0,r=a.length;n<r;n++){var o=a[n],i=document.createElement("option");i.value=o,B(i,{id:data.careers[o].name,fallback:o,key:"career"+n}),t.appendChild(i)}e.appendChild(t),e.addEventListener("change",function(e){p(e.target.value)}),s=e}(),function(){var e=m.getElementsByClassName("career-and-gear")[0],t=C.items;t[0]={},t[0].container=e.getElementsByClassName("item-container")[0];for(var a=t[0].container.cloneNode(!0),n=0;t.length<5;){if(0!==n&&(t[n]={},t[n].container=t[n].container||a.cloneNode(!0),1<n&&(t[n].container.textContent=data.careers.dr_ranger.equipment[n]),4===n&&t[n].container.classList.add("item-container-last")),n<2){var r=document.createElement("div");r.classList.add("select-weapon"),r.classList.add("js-button"),r.setAttribute("data-weapon-select",n),t[n].weapon={},t[n].weapon.div=r,t[n].weapon.div.textContent="Weapon "+(n+1),t[n].container.classList.add("item-weapon"),t[n].container.appendChild(r)}t[n].property=[];for(var o=0;o<2;o++){(i=document.createElement("select")).classList.add("select-property"),i.classList.add("js-input"),i.setAttribute("data-item-slot",n),i.setAttribute("data-property-slot",o),i.innerHTML="<option selected disabled hidden>Property</option>",i.addEventListener("change",c),t[n].property[o]={},t[n].property[o].select=i,t[n].property[o].options=[],t[n].container.appendChild(i)}for(o=0;o<1;o++){var i;(i=document.createElement("select")).classList.add("select-trait"),i.classList.add("js-input"),i.innerHTML="<option selected disabled hidden>Trait</option>",t[n].trait={},t[n].trait.select=i,t[n].trait.options=[],t[n].trait.name=null;var s=t[n].trait;i.addEventListener("change",d(s)),t[n].container.appendChild(i)}e.appendChild(t[n].container),n++}}(),function(){for(var e=m.getElementsByClassName("talent-tree")[0],t=document.createDocumentFragment(),a=data.careers.dr_ranger.talent_tree.length,n=0;n<a;n++){w[n]=[];var r=document.createElement("div");r.classList.add("talent-row");for(var o=0;o<3;o++){var i=document.createElement("div");i.classList.add("talent"),i.classList.add("js-button"),w[n][o]={},w[n][o].div=i,r.appendChild(i);i.addEventListener("mousedown",_(n,o))}t.appendChild(r)}e.appendChild(t)}(),T(),(t=document.getElementsByClassName("copy-build")[0]).addEventListener("click",function(e){C.encode(t)}),TooltipControl(t).text("Copies a url for this build containing\r\nselected career, items, and talents.\r\n\r\nOnly works with valid combinations."),function(){for(var e={},t=Object.keys(data.item.property_combos),a=0,n=t.length;a<n;a++){e[t[a]]={};for(var r=data.item.property_combos[t[a]],o=0,i=r.length;o<i;o++)e[t[a]][r[o][0]]=e[t[a]][r[o][0]]||{},e[t[a]][r[o][0]][r[o][1]]=!0,e[t[a]][r[o][1]]=e[t[a]][r[o][1]]||{},e[t[a]][r[o][1]][r[o][0]]=!0}x.property_combos=e}(),I.refresh(),E(),C.getMultipliers(),verminted.refresh[verminted.refresh.length]=C.refresh,verminted.update_weapon_list[verminted.update_weapon_list.length]=function(e){var t=C.career.name,a=Object.keys(x.weapon),n={};if(t)for(var r=e.target.getAttribute("data-weapon-select"),o=t,i=data.careers[o].equipment[r],s=x.lookup[o][i],l=0,c=s.length;l<c;l++)n[s[l]]=!0;else for(l=0,c=a.length;l<c;l++)n[a[l]]=!0;for(l=0,c=a.length;l<c;l++)n[a[l]]?x.weapon[a[l]].div.classList.remove("hide"):x.weapon[a[l]].div.classList.add("hide")},verminted.do_not_open_build?window.setTimeout(function(){C.refresh()},100):C.modal.open(),C},WeaponListModal=function(){var r=ModalControl(document.getElementsByClassName("weapon-list-holder")[0]);return r.onClick=function(e){e.stopPropagation();for(var t=e.target,a=!0;t&&t.classList;){if(t.classList.contains("weapon-list-holder")){a=!1;break}if(t.getAttribute("data-weapon")){var n=t.getAttribute("data-weapon");r.clickCallback(n),a=!0;break}t.classList.contains("select-weapon")&&(a=!1),t=t.parentNode}a&&r.close()},r},WeaponSelection=function(i){var e={},r=verminted.weapon_list,s=verminted.attack_chain;e.update=[];function o(e){var t=i.getAttribute("data-weapon-select"),a=verminted.weapon_slot[t];i.textContent=e,i.setAttribute("data-input",e);for(var n=verminted.update_weapon,r=0,o=n.length;r<o;r++)n[r](e,t,a);s.setWeapon(e,parseInt(i.getAttribute("data-weapon-select"),10))}return i.addEventListener("click",function(e){r.setClickCallback(o);for(var t=verminted.update_weapon_list,a=0,n=t.length;a<n;a++)t[a](e);r.open()}),e};function populateAttackCombo(e,t){function a(s,l){var c={},d=document.createElement("div"),e=document.createElement("div");e.classList.add("mob-name"),e.textContent=s,c.mob_name=e,d.appendChild(e),c.targets=[];for(var t=0;t<f;t++){var a=document.createElement("div");a.classList.add("breakpoint-row"),c.targets[t]={},c.targets[t].row=a;for(var n=0;n<p.length;n++){var r=p[n],o=document.createElement("div");o.classList.add("breakpoint"),o.classList.add(r),c.targets[t][r]=o,a.appendChild(o)}d.appendChild(a)}var i=document.createElement("div");i.classList.add("extra-target-row"),i.classList.add("hide"),c.extra_targets=i,d.appendChild(i),c.container=d;var _=verminted.callback_on_data.length;return verminted.callback_on_data[_]=function(){data.breeds;var e,t=data.breeds[s],a=t.primary_armor||t.armor;e=t.hitzone_primary_armor?t.hitzone_primary_armor.head:t.hitzone_armor?t.hitzone_armor.head:a;for(var n=0;n<c.targets.length;n++){c.targets[n].row;for(var r=0;r<p.length;r++){var o,i=p[r];o="headshot"===i||"both"===i?e:a,c.targets[n][i].classList.add(o)}}l.appendChild(d)},c}var n={},r=Object.keys(constants.mob_lookup),p=constants.hit_types,f=(constants.armor_types,verminted.max_targets);n.weapon=[];for(var o=document.getElementsByClassName("weapon-breakpoints-container"),i=0;i<o.length;i++){var s,l=o[i].getElementsByClassName("weapon-breakpoints")[0];n.weapon[i]={},n.weapon[i].container=l,n.weapon[i].name_div=o[i].getElementsByClassName("weapon-name")[0],(s=document.createElement("div")).classList.add("breakpoint-plate");for(var c={},d=0,_=r.length;d<_;d++){var m=a(r[d],s);c[r[d]]=m}n.weapon[i].breeds=c;!function(){var e=s,t=o[i].getElementsByClassName("weapon-breakpoints-attacks")[0],a=!0;n.weapon[i].name_div.addEventListener("click",function(){(a=!a)?(t.classList.remove("hide"),e.classList.remove("hide")):(t.classList.add("hide"),e.classList.add("hide"))})}(),l.appendChild(s)}n.combo={},n.combo.container=document.getElementsByClassName("attack-combo")[0],n.combo.info={},n.combo.info.container=document.createElement("div"),n.combo.info.container.classList.add("combo-info"),n.combo.info.container.classList.add("hide"),n.combo.info.attack_speed=document.createElement("div"),n.combo.info.damage_box={},n.combo.info.damage_box.container=document.createElement("div"),n.combo.info.damage_box.dps={},n.combo.info.damage_box.container.classList.add("combo-damage-box"),n.combo.info.container.appendChild(n.combo.info.attack_speed),n.combo.info.container.appendChild(n.combo.info.damage_box.container),n.combo.breeds={},(s=document.createElement("div")).classList.add("breakpoint-plate"),s.classList.add("hide");for(c={},d=0,_=r.length;d<_;d++){m=a(r[d],s);c[r[d]]=m}return n.combo.breeds=c,n.combo.container.appendChild(n.combo.info.container),n.combo.container.appendChild(s),n}function getWeaponBuffType(e){return data.weapons[e].buff_type}function getWeaponType(e){return data.weapons[e].weapon_type}function getBuildWeapon(e){return verminted.build.weapon[e]}function isWeaponMelee(e){return"MELEE_1H"===data.weapons[e].buff_type||"MELEE_2H"===data.weapons[e].buff_type}function getProfileChargeType(e){return data.profiles[e].charge_value}function getCareerTalent(e,t,a){return data.careers[e].talent_tree[t][a]}function getCurrentCareerTalent(e){var t=verminted.build.career.name,a=verminted.build.career.talents,n=!1;return isNaN(a[e])||(n=getCareerTalent(t,e,a[e])),n}function getBuff(e){var t=!1;return data.buffs[e]&&(t=data.buffs[e]),t}function getDifficulty(){return verminted.difficulty}function getDifficultySettings(){return data.globals.difficulty_settings[getDifficulty()]}var VermBigInt=function(){var e={},_=1e5;e.printraw=function(e){for(var t="",a=0;a<e.length;a++){for(var n=""+e[a];n.length<5&&a<e.length-1;)n="0"+n;t=n+t}console.log(t)};function r(e,t){var a,n,r=[];e.length>t.length?(a=e,n=t):(n=e,a=t);for(var o=0,i=0;i<a.length||0<o;i++){var s=(a[i]||0)+(n[i]||0)+o;_<=s?s-=(o=1)*_:o=0,r[i]=s}return r}function o(e,t){var a,n=[];a=e.length>=t.length?e:t;for(var r=0,o=0;o<a.length;o++){var i=(e[o]||0)-((t[o]||0)+r);i<0?"number"==typeof e[o+1]&&(r=1,i+=_,n[o]=i):0<i?(r=0,n[o]=i):e[o+1]?(r=0,n[o]=0):r=0}return n}function i(e,t){if(e.length>t.length)return!0;if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++){var n=e.length-1-a,r=e[n],o=t[n];if(o<r)return!0;if(r<o)return!1}return!0}return e.biNew=function(e){var t=Math.floor(e),a=[],r=function(e,t,a){for(;;){if(!(_<=t))return e[a]=t;var n=Math.floor(t/_);t-=r(e,n,a+1)*_}};return r(a,t,0),a},e.add=function(e,t){return r(e,t)},e.sub=function(e,t){return o(e,t)},e.mul=function(e,t){for(var a=e,n=1;n<t;n++)a=r(a,e);return 0!==a.length&&0!==t||((a=[])[0]=0),a},e.div=function(e,t){var a=0,n=e;if("object"==typeof t)for(;i(n,t)&&a<30;)n=o(n,t),a++;else{var r=function(e,t){for(var a=[0],n=0,r=0,o=0;o<e.length;o++){var i=e.length-1-o,s=e[i]/t,l=n;if(_<(n=(r=s%1+l%1)*_)){var c=Math.floor(n/_);n-=c*_,r-=c,l+=c}var d=s-s%1+(l-l%1);0<d&&(a[i]=d)}return[a,r]}(e,t);n=r[0],a=Math.ceil(r[1]*t)%t}return[n,a]},e},BigInt=BigInt;function VermintedCompress(){var v={},g={career:15,talent1:3,talent2:3,talent3:3,talent4:3,talent5:3,talent6:3,wep1:10,wep2:8,wep1props:27,wep2props:27,neckprops:20,charmprops:25,trinketprops:21,wep1traits:7,wep2traits:7,necktraits:5,charmtraits:5,trinkettraits:3},h=["career","talent1","talent2","talent3","talent4","talent5","talent6","wep1","wep2","wep1props","wep2props","neckprops","charmprops","trinketprops","wep1traits","wep2traits","necktraits","charmtraits","trinkettraits"],b=VermBigInt();void 0===BigInt?(v.big_int=!1,BigInt=function(e){return e}):v.big_int=!0;var k={_Rixits:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_",toNumber:function(e){var t=0;e=e.split("");for(var a=0;a<e.length;a++)t=64*t+this._Rixits.indexOf(e[a]);return t},fromBigInt:function(e){for(var t,a="",n=e;t=Number(n%BigInt(64)),a=this._Rixits.charAt(t)+a,(n/=BigInt(64))!=BigInt(0););return a},fromVBI:function(e){for(var t,a="",n=0,r=e;;){var o=b.div(r,64);if(t=o[1],a=this._Rixits.charAt(t)+a,1===(r=o[0]).length&&0===r[0]||0===r.length||15<n)break;n++}return a},toBigInt:function(e){var t=BigInt(0);e=e.split("");for(var a=0;a<e.length;a++)t=t*BigInt(64)+BigInt(this._Rixits.indexOf(e[a]));return t},toVBI:function(e){var t=[0];e=e.split("");for(var a=0;a<e.length;a++)t=b.add(b.mul(t,64),[this._Rixits.indexOf(e[a])]);return t}};return v.encode=function(e){for(var t=vermintedLookup(63),a=e.career.name,n=[],r=[],o=[],i=0;i<e.items.length;i++)r[i]=e.items[i].type,"dr_slayer"===a&&"throwing_axes"===e.items[i].name?o[i]="melee":o[i]=r[i];return n[0]=t.careers[a],n[1]=e.talents[0].col,n[2]=e.talents[1].col,n[3]=e.talents[2].col,n[4]=e.talents[3].col,n[5]=e.talents[4].col,n[6]=e.talents[5].col,n[7]=t.weapons[a][o[0]][e.items[0].name],n[8]=t.weapons[a][o[1]][e.items[1].name],n[9]=t.properties[r[0]][e.items[0].property[0].name][e.items[0].property[1].name],n[10]=t.properties[r[1]][e.items[1].property[0].name][e.items[1].property[1].name],n[11]=t.properties[r[2]][e.items[2].property[0].name][e.items[2].property[1].name],n[12]=t.properties[r[3]][e.items[3].property[0].name][e.items[3].property[1].name],n[13]=t.properties[r[4]][e.items[4].property[0].name][e.items[4].property[1].name],n[14]=t.traits[e.items[0].trait_type][e.items[0].trait.name],n[15]=t.traits[e.items[1].trait_type][e.items[1].trait.name],n[16]=t.traits[e.items[2].trait_type][e.items[2].trait.name],n[17]=t.traits[e.items[3].trait_type][e.items[3].trait.name],n[18]=t.traits[e.items[4].trait_type][e.items[4].trait.name],function(e){var t="";if(v.big_int){for(var a=BigInt(1),n=BigInt(0),r=0;r<h.length;r++)n+=a*BigInt(e[r]),a*=BigInt(g[h[r]]);var o=(t=k.fromBigInt(n)).length;for(r=0;r<10-o;r++)t="0"+t}else{for(a=[1],n=[0],r=0;r<h.length;r++){var i=b.mul(a,e[r]);n=b.add(n,i),a=b.mul(a,g[h[r]])}for(o=(t=k.fromVBI(n)).length,r=0;r<10-o;r++)t="0"+t}return t}(n)},v.decode=function(e){for(var t=vermintedLookup(63).index,a=0;a<e.length;a++)e.charAt(a);var n=function(e){var t=new Array(h.length);if(v.big_int){for(var a=Number,n=k.toBigInt(e),r=BigInt(1),o=0;o<h.length;o++)r*=BigInt(g[h[o]]);for(o=0;o<h.length;o++){var i=n/(r/=BigInt(g[h[l=h.length-1-o]]))%BigInt(g[h[l]]);t[l]=a(i),n%=r}}else{n=k.toVBI(e),r=[[1]];var s=[1];for(o=0;o<h.length;o++)s=b.mul(s,g[h[o]]),r[o+1]=s;for(o=0;o<h.length;o++){var l=h.length-1-o;i=(n=b.div(n,r[l]))[1];t[l]=i,n=n[0]}}return t}(e),r={talents:[],items:[]},o=t.careers[n[0]],i=[],s=[],l=data.careers[o].equipment;for(a=0;a<l.length;a++)s[a]=l[a],r.items[a]={};var c=t.weapons[o][s[0]].length;i[0]=t.weapons[o][s[0]][n[7]%c],c=t.weapons[o][s[1]].length,i[1]=t.weapons[o][s[1]][n[8]%c];var d=[];for(a=0;a<l.length;a++)data.weapons[i[a]]?d[a]=data.weapons[i[a]].traits:d[a]=s[a];r.career=o,r.talents[0]=n[1],r.talents[1]=n[2],r.talents[2]=n[3],r.talents[3]=n[4],r.talents[4]=n[5],r.talents[5]=n[6],r.items[0].weapon=i[0],r.items[1].weapon=i[1];var _=9;for(a=0;a<5;a++){var p=a+_,f=t.properties[s[a]].length,m=s[a];"dr_slayer"===o&&"throwing_axes"===i[a]&&(m="ranged"),r.items[a].properties=t.properties[m][n[p]%f]}_=14;for(a=0;a<5;a++){p=a+_;var u=t.traits[d[a]].length;r.items[a].trait=t.traits[d[a]][n[p]%u]}return r},v}function vermintedLookup(e){var t={},a={},n=Object.keys(data.careers).sort(),r=Object.keys(data.weapons).sort(),o=Object.keys(data.item.property_combos),i=Object.keys(data.item.trait_combos);t.careers={},a.careers=[];for(var s=0;s<n.length;s++)t.careers[n[s]]=s,a.careers[s]=n[s];t.weapons={},a.weapons={};for(s=0;s<r.length;s++){var l=data.weapons[r[s]].type;if(e<1)var c=Object.keys(data.weapons[r[s]].career);else c=Object.keys(data.weapons[r[s]].career).sort();for(var d=0;d<c.length;d++){var _=c[d],p=l;"dr_slayer"===_&&"throwing_axes"===r[s]&&(p="melee"),t.weapons[_]=t.weapons[_]||{},a.weapons[_]=a.weapons[_]||{},t.weapons[_][p]=t.weapons[_][p]||{},a.weapons[_][p]=a.weapons[_][p]||[];var f=Object.keys(t.weapons[_][p]).length;t.weapons[_][p][r[s]]=f,a.weapons[_][p][f]=r[s]}}t.properties={},a.properties={};for(s=0;s<o.length;s++){var m=o[s];t.properties[m]={},a.properties[m]=[];var u=data.item.property_combos[o[s]];for(d=0;d<u.length;d++)t.properties[m][u[d][0]]=t.properties[m][u[d][0]]||{},t.properties[m][u[d][0]][u[d][1]]=d,t.properties[m][u[d][1]]=t.properties[m][u[d][1]]||{},t.properties[m][u[d][1]][u[d][0]]=d,a.properties[m][d]=[u[d][0],u[d][1]]}t.traits={},a.traits={};for(s=0;s<i.length;s++){t.traits[i[s]]={},a.traits[i[s]]=[];var v=data.item.trait_combos[i[s]].sort();e<1&&(v=data.item.trait_combos[i[s]]);for(d=0;d<v.length;d++)t.traits[i[s]][v[d]]=d,a.traits[i[s]][d]=v[d]}return t.index=a,t}function resourceButton(){for(var e=this.parentNode,t=this.parentNode.parentNode.children,a=0;a<t.length;a++){var n=t[a];n!==e&&n.classList.toggle("hide")}}function prepPage(){constants=InitConstants(),document.getElementsByClassName("default-language")[0].textContent=verminted.language;for(var e=document.getElementsByClassName("input-power-level"),t=0;t<e.length;t++)e.textContent=verminted.power_level-235;var a=document.getElementsByClassName("appended-link");for(t=0;t<a.length;t++){var n=a[t].href.split("?")[1];a[t].href=window.location.search+"?"+n}var r=document.getElementsByClassName("select-difficulty")[0],o=document.createDocumentFragment(),i=Object.keys(constants.difficulties);for(t=0;t<i.length;t++){var s=i[t],l=document.createElement("option");l.textContent=s,(l.value=s)===verminted.difficulty&&l.setAttribute("selected",!0),o.appendChild(l)}r.appendChild(o),r.addEventListener("change",verminted.set_difficulty),verminted.callback_on_data=[],verminted.update_weapon_list=[],verminted.update_weapon=[],verminted.update_on_build=[],verminted.tooltip=document.getElementsByClassName("tooltip")[0],verminted.tooltips={},verminted.weapon_buttons={},verminted.weapon_slot={};for(var c=document.getElementsByClassName("select-page"),d=(t=0,c.length);t<d;t++)c[t].addEventListener("click",function(e){pageSelection(e.target)});for(var _=document.getElementsByClassName("build-button"),p=(t=0,_.length);t<p;t++)_[t].addEventListener("click",function(e){verminted.build.modal.open(),e.stopPropagation()});var f=document.getElementsByClassName("toggle-hbfs");for(t=0;t<f.length;t++){f[t].addEventListener("change",verminted.set_harder_better),TooltipControl(f[t]).text("Harder, Better, Faster, Stronger\r\ndoubles elites' hp")}var m=document.getElementsByClassName("select-headshot-percent")[0];m.addEventListener("change",function(e){var t=e.target.valueAsNumber;t=100<t?100:0<t?t:0,m.value=t,verminted.combo_breakpoints.headshot_chance=t/100,verminted.build.refresh()}),TooltipControl(m).text("Percentage of hits that\r\nare headshots for DPS");var u=document.getElementsByClassName("resource-title");for(t=0;t<u.length;t++){for(var v=u[t],g=v.parentNode,h=v.parentNode.parentNode.children,b=0;b<h.length;b++){var k=h[b];k!==g&&k.classList.toggle("hide")}v.onclick=resourceButton}var w=populateAttackCombo();verminted.combo_breakpoint_table=w.combo,verminted.weapon_breakpoint_table=[],verminted.weapon_breakpoint_table[0]=w.weapon[0],verminted.weapon_breakpoint_table[1]=w.weapon[1],verminted.weapon_attack_breakpoints=[];for(t=0;t<verminted.weapon_breakpoint_table.length;t++)verminted.weapon_attack_breakpoints[t]=AttackBreakpoints(verminted.weapon_breakpoint_table[t],t);verminted.combo_breakpoints=ComboBreakpoints(verminted.combo_breakpoint_table),waitForData()}function waitForData(){DATA_FINISHED?finishPage():setTimeout(waitForData,5)}function finishPage(){var e=document.getElementById("build");e.textContent=data.vermintide+" "+e.textContent;for(var t=0;t<verminted.callback_on_data.length;t++)verminted.callback_on_data[t]();var a=document.getElementsByClassName("select-language")[0],n=["en","zh","pl","ru","fr","es","it","pt","de","disabled"];for(t=0;t<n.length;t++){var r=n[t],o=document.createElement("option");(o.textContent=r)===verminted.language&&o.setAttribute("selected",!0),a.addEventListener("change",function(e){verminted.set_language(e)}),a.appendChild(o)}verminted.compression=VermintedCompress();var i=window.location.search;if(i){var s=i.split("?");for(t=0;t<s.length;t++){var l,c=s[t];switch(c){case"shadeult":verminted.temp_shade_ult=!0,pageSelection(document.getElementsByClassName("select-page")[1]);break;case"compareconsole":document.getElementsByClassName("select-file")[0].addEventListener("change",compareConsole),document.getElementsByClassName("select-file")[0].classList.remove("hide");break;case"dontopenbuild":verminted.do_not_open_build=!0;break;default:10===c.length&&(l=s[t])}}}for(var d=Object.keys(data.globals),_=0,p=d.length;_<p;_++)constants[d[_]]=data.globals[d[_]];var f=document.getElementsByClassName("input-power-level");for(t=0;t<f.length;t++)f[t].value=verminted.power_level-constants.starting_power_level,f[t].addEventListener("change",verminted.set_power_level);populateElements(),verminted.weapon_list=WeaponListModal(),verminted.damage=WeaponDamage(),verminted.attack_chain=AttackChain(document.getElementsByClassName("chain-attack-container")[0]),verminted.buffs={},verminted.buffs.global_buffs=GlobalBuffs(),verminted.buffs.trigger_funcs=TriggerFuncs(),verminted.buffs.buff_funcs=BuffFuncs(),verminted.buffs.update_funcs=UpdateFuncs(),verminted.buffs.buff_array=BuffArray(),verminted.build=BuildBuild(),verminted.buffs.buff_funcs.init(),verminted.timeline=ComboTimeline();for(var m=document.getElementsByClassName("select-weapon"),u=(t=0,m.length);t<u;t++){var v=uniqueID(m[t]);verminted.tooltips[v];verminted.weapon_buttons[v]=WeaponSelection(m[t]),verminted.weapon_slot[t]=document.getElementsByClassName("weapon-attacks")[t],verminted.tooltips[v]=TooltipControl(m[t]),verminted.tooltips[v].text("Weapon "+(t+1))}l&&verminted.build.decode(l);var g=["skaven_slave","skaven_clan_rat","chaos_fanatic","chaos_marauder","beastmen_gor","beastmen_ungor_archer","skaven_plague_monk","chaos_berzerker","skaven_storm_vermin","beastmen_bestigor","chaos_raider","chaos_warrior","chaos_vortex_sorcerer","chaos_corruptor_sorcerer","skaven_poison_wind_globadier","skaven_gutter_runner","skaven_warpfire_thrower","skaven_ratling_gunner","skaven_pack_master","beastmen_standard_bearer","skaven_rat_ogre","skaven_stormfiend","chaos_spawn","chaos_troll","beastmen_minotaur","chaos_exalted_champion_warcamp","skaven_storm_vermin_warlord","chaos_exalted_sorcerer","chaos_exalted_champion_norsca","chaos_spawn_exalted_champion_norsca","skaven_stormfiend_boss","skaven_grey_seer"],h=["recruit","veteran","champion","legend","cataclysm","cataclysm_2","cataclysm_3"],b=document.getElementsByClassName("mob-hp-list")[0];for(t=0;t<g.length;t++){var k=document.createElement("p");k.style.display="inline-block",k.style.whiteSpace="pre-wrap";for(var w="",y=data.breeds[g[t]],C=0;C<h.length;C++)if("number"==typeof y.max_health[h[C]]){var x=y.max_health[h[C]].toString(),L=x.replace(".","").length,B="";B+=x+"&#09;",L<4&&(B+="&#09;"),w+=B}k.innerHTML=w,k.textContent+=" // "+g[t],b.appendChild(k)}void 0!==WeaponStagger&&(verminted.stagger=WeaponStagger(),verminted.stagger.staggerTest(),verminted.stagger.staggerTest())}var WeaponStagger=WeaponStagger;window.onpopstate=function(e){var t=e.state;t.build.build_code&&verminted.build.decode(t.build.build_code)},void 0===document.getElementsByClassName&&(document.getElementsByClassName=function(e){var t="."+e.replace(/ /g,".");return document.querySelectorAll(t)});