const build="52",date="25/3/2019";function DefaultSettings(){var t={refresh:[]};let a=function(){for(let e=0;e<t.refresh.length;e++)t.refresh[e]()};return t.max_targets=5,t.anim_cancel=.05,t.difficulty="legend",t.set_difficulty=function(n){let e=n.target,o=e.value;if(!constants.difficulties[o])throw"difficulty is not registered!";else t.difficulty=o,a()},t.power_level=785,t.set_power_level=function(n){let e=n.target,o=e.valueAsNumber;if(isNaN(o))throw"power_level is NaN!";600<o?(o=600,e.value=600):15>o&&(o=15,e.value=15),t.power_level=o+185,a()},t.platform=!1,t.set_platform=function(n){let e=n.target,o=e.value;t.platform="console"==o,t.difficulty="legend",a()},t.profiles={},t}var verminted=DefaultSettings();function InitConstants(){return{armor_types:["infantry","armored","monster","friendly_fire","berserker","superarmored"],hit_types:["neither","headshot","critical","both"],attack_types:["light","push","heavy","dot"],dual_profile:["damage_profile_right","damage_profile_left"],characters:{bw_scholar:"sienna",bw_adept:"sienna",bw_unchained:"sienna",es_mercenary:"kruber",es_huntsman:"kruber",es_knight:"kruber",dr_ranger:"bardin",dr_ironbreaker:"bardin",dr_slayer:"bardin",we_waywatcher:"kerillian",we_maidenguard:"kerillian",we_shade:"kerillian",wh_captain:"saltzpyre",wh_bountyhunter:"saltzpyre",wh_zealot:"saltzpyre"},mob_lookup:{skaven_slave:"infantry",skaven_clan_rat:"infantry",chaos_fanatic:"infantry",chaos_marauder:"infantry",skaven_plague_monk:"berserker",chaos_berzerker:"berserker",skaven_storm_vermin:"armored",chaos_raider:"infantry",chaos_warrior:"superarmored",chaos_vortex_sorcerer:"infantry",chaos_corruptor_sorcerer:"infantry",skaven_poison_wind_globadier:"infantry",skaven_gutter_runner:"infantry",skaven_warpfire_thrower:"armored",skaven_ratling_gunner:"armored",skaven_pack_master:"monster"},difficulties:{deathwish:!0,legend:!0,champion:!0,veteran:!0,recruit:!0}}}var constants=InitConstants(),UID=0;function uniqueID(e){if(e.getAttribute("data-id"))return e.getAttribute("data-id");else{UID++;let t=UID;return e.setAttribute("data-id",t),t}}String.prototype.hashCode=function(){var e,t,a=0;if(0===this.length)return a;for(e=0;e<this.length;e++)t=this.charCodeAt(e),a=(a<<5)-a+t,a|=0;return a};let concateObject=function(e){let t="";if("object"==typeof e){let a,n=0;if(e.isArray){n=e.length;for(let e=0;e<n;e++)a[e]=e}else a=Object.keys(e),n=a.length;for(let o=0;o<n;o++)t+=concateObject(e[a[o]])}else t+=e;return t};function pageSelection(e){let t=document.getElementsByClassName(e.getAttribute("data-slot"))[0],a=document.getElementsByClassName("main-page");for(let n=0;n<a.length;n++)a[n]==t?a[n].classList.remove("hide"):a[n].classList.add("hide")}let GenericMath=function(){let e={};return e.clamp=function(e,t,a){let n=0;return n=e>=a?a:e<=t?t:e,n},e.getPowerPercentage=function(e){let t=constants.min_power_level,a=constants.max_power_level;return(e-t)/(a-t)},e.scalePower=function(e){var t=Math.min;let a=verminted.power_level,n=verminted.difficulty;"deathwish"===n&&(n="legend");let o=constants.difficulty_settings[n],i=o.power_level_cap,r=o.power_level_max_target,s=0;if(i<a&&r){let e=a-i;a=i+r*e/(800-i)}else a=t(a,i);if(a>=constants.min_power_level_cap){let t,n=100,o=5;if(a>=constants.min_power_level_cap+n)t=(a-constants.min_power_level_cap)*(constants.power_level_diff_ratio[e]-1)/(o-1),verminted.platform&&"attack"===e&&(t*=1.4);else{let i=50*(1-(a-200)/n);t=(a+i-constants.min_power_level_cap)*(constants.power_level_diff_ratio[e]-1)/(o-1),verminted.platform&&"attack"===e&&(t=1.4*(t-200)+200)}s=constants.min_power_level_cap+t}else s=a;return s},e.getPower=function(t,a,n,o,i){let r,s=n.power_multiplier||a.power_multiplier||constants.default_power_multiplier,p=n.power_multiplier_near||a.power_multiplier_near,l=n.power_multiplier_far||a.power_multiplier_far;r=p&&l&&0<=i?0===i?p[t]:l[t]:s[t];let c=e.scalePower(t);return c*r},e.getCleave=function(t){let a=e.scalePower("cleave"),n=t.cleave_coefficient||constants.default_cleave_coefficient,o=constants.cleave.max-constants.cleave.min,i=a*n.attack,r=e.getPowerPercentage(i);return o*r},e.getArmorMultiplier=function(e,t,a,n,o,i,r){let s,p,l=a.armor_multiplier||t.armor_multiplier||constants.default_power_multiplier,c=a.armor_multiplier_near||t.armor_multiplier_near,d=a.armor_multiplier_far||t.armor_multiplier_far;return i&&(p=i[e]),s=p&&p[n]?o&&p[o]||p[n]:c&&d&&0<=r?0===r?o&&0<=c[e][o]?c[e][o]:0<=c[e][n]?c[e][n]:1:o&&0<=d[e][o]?d[e][o]:0<=d[e][n]?d[e][n]:1:o&&0<=l[e][o]?l[e][o]:0<=l[e][n]?l[e][n]:1,s},e.getPowerForUnit=function(t,a,n,o,i,r,s,p){let l=t.targets&&t.targets[a]||t.default_target,c=n&&t.critical_multiplier;p&&(r=0,s=0);let d=e.getArmorMultiplier("attack",t,l,r,s,c,i),m=e.getPower("attack",t,l,c,i);m*=d;return m},e},WeaponDamage=function(){var e=Math.floor;let a=GenericMath(),n={};return a.modifyBoostCurve=function(e,t){let a={};for(let n=0,o=e.length;n<o;n++)a[n]=e[n]*t;return a},a.clampCurveValue=function(e,t){let a=Object.keys(e).length-1;return 0>t?e[0]:t>a?e[a]:e[t]},a.getBoostCurveMultiplier=function(n,o){let i=Object.keys(n).length-1,r=i*o,s=e(r),p=r-e(r),t=a.clampCurveValue(n,s-1),l=a.clampCurveValue(n,s+0),c=a.clampCurveValue(n,s+1),d=a.clampCurveValue(n,s+2);return(-t/2+3*l/2-3*c/2+d/2)*p*p*p+(t-5*l/2+2*c-d/2)*p*p+(-t/2+c/2)*p+l},a.calculateDamage=function(e,t,n,o,i,r,s,p,l,c,d,m){var _=Math.max;if(e.no_damage)return 0;let u={headshot:!0,weakspot:!0,protected_weakspot:!0},h=e.targets&&e.targets[d]||e.default_target,g=constants.boost_curves[h.boost_curve_type]||constants.boost_curves["default"],w={max:100,min:0},b=verminted.difficulty,f=0,y=0,k=1;if(u[t]||n||r||s&&1<s){let o=1==l||4==l||5==l?1:l;let p=w.max,m=a.getPowerForUnit(e,d,n,t,i,l,c,o),_=a.getPowerPercentage(m),h=p*_;(u[t]||n)&&(k=.5*h),(r||s&&0<s)&&(f=h)}let x=0,v=w,C=v.max-v.min,E=a.getPowerForUnit(e,d,n,t,i,l,c),L=a.getPowerPercentage(E);x=v.min+C*L;let N;o&&(N=f&&x<f&&f*(o-1)||x*(o-1));let B=0,A=0;if(r){B+=[.75,.6,.5,.5,.5,.3][l]}if(s&&0<s){B+=[.75,.3,.75,.5,.5,.2][l]}u[t]&&(0<x?2==l?A+=h&&(h.headshot_boost_boss||h.headshot_boot)||.25:A+=h&&(h.headshot_boost_armor||h.headshot_boost)||.5:5==c&&0==x?A+=h&&(h.headshot_boost_heavy_armor||.25):1==l&&0==x&&(A+=h&&(h.headshot_boost_armor||h.headshot_boost)||.5),"protected_weakspot"==t&&(A*=.25)),"protected_spot"==t&&(B-=.5,A-=.5),e&&e.no_headshot_boost&&(A=0);let P=0;if(n&&(P=e.crit_boost||.5,e.no_crit_boost&&(P=0)),g&&(0<B||0<A||0<P)){let e,t,n=h&&h.power_boost_curve_coefficient||1,o=h&&h.boost_curve_coefficient||1;if(s&&0<s&&(n*=s,o*=s),0<B){e=a.modifyBoostCurve(g,n),B=a.clamp(B,0,1);let t=a.getBoostCurveMultiplier(e||g,B);f=_(_(f,x),1)*t}if(0<A||0<P){t=a.modifyBoostCurve(g,o),A=a.clamp(A+P,0,1);let e=t||g,n=a.getBoostCurveMultiplier(e,A);y=_(_(f,x),k)*n,0<P&&(y*=1+m)}}return x=x+f+y,N&&(x+=N),x},a.compileProfile=function(e,t){let o=verminted.build.getWeaponIndex(e),i=verminted.build.weapon[o].crit_boost,r=verminted.build.weapon[o].power_boost,s=verminted.build.weapon[o].has_power_boost,p=""+i+r+s+verminted.platform+verminted.difficulty.charAt(4)+verminted.power_level,l=(t+p).hashCode();if(n[t]===l)return;n[t]=l;let c={},d=data.profiles[t],m=constants.armor_types,_=constants.hit_types;for(let n=0,o=m.length;n<o;n++){3==n&&(n=4);let e=n,o=n;5==n&&(e=1);let r=m[n];c[r]={};for(let n=0;n<_.length;n++){let p,l,m,u,h,g=_[n];data.profiles[t].duration?h=1!=n&&(2==n||3==n):1==n?(u="headshot",h=!1):2==n?(u=null,h=!0):3==n?(u="headshot",h=!0):(u=null,h=!1),c[r][g]={};for(let t,n=0;5>n&&(t=a.calculateDamage(d,u,h,p,0,s,l,m,e,o,n,i),!(0<n&&t>c[r][g][n-1]));n++)c[r][g][n]=t}}verminted.profiles[t]=verminted.profiles[t]||{},verminted.profiles[t].crit_boost=i,verminted.profiles[t].power_boost=r,verminted.profiles[t].damage=c},a.getDamage=function(e,t,n,o,i,r){a.compileProfile(e,t);let s=verminted.build.getWeaponIndex(e),p=verminted.build.weapon[s].multipliers,l=n;"superarmored"===n&&(l="armored");let c=p[r]||1,d=p[l]||1,m=p.power||1,_=verminted.profiles[t].damage,u=_[n][o][i];return u=u*c*d*m,u},a},WeaponBreakpoints=function(){var e=Math.ceil;let t={};t.chain=[],t.mob_lookup=constants.mob_lookup,t.hit_types=constants.hit_types,t.damage_profiles=[],t.pullDamage=function(a,n,o){let i=t.chain,r=t.hit_types,s=t.damage_profiles;if(!t.mob_lookup[a]){throw`${a} does not have assigned armor type`}data.breeds[a];let p=data.breeds[a],l=p.race,c=verminted.difficulty,d=p.primary_armor||p.armor,m=d;p.hitzone_primary_armor?m=p.hitzone_primary_armor.head.attack||p.hitzone_primary_armor.head:p.hitzone_armor&&(m=p.hitzone_armor.head.attack||p.hitzone_armor.head);let _={};for(let t=n;t<n+(o||1);t++){let n=s[t].weapon,o=s[t].action,i=s[t],p=data.weapons[n].actions[o],c=0;if(i.aoe_profile)c=2;else{let t,n=verminted.damage.getCleave(data.profiles[i.profile]);t=p.hit_mass&&constants.hit_mass[p.hit_mass][a]?data.breeds[a].hit_mass_counts&&data.breeds[a].hit_mass_counts[verminted.difficulty]?constants.hit_mass[p.hit_mass][a]*data.breeds[a].hit_mass_counts[verminted.difficulty]:data.breeds[a].hit_mass_count||20:data.breeds[a].hit_mass_counts&&data.breeds[a].hit_mass_counts[verminted.difficulty]?data.breeds[a].hit_mass_counts[verminted.difficulty]:data.breeds[a].hit_mass_count||20,i.max_targets=i.dot?s[i.parent_index].max_targets:e(n/t),c=i.max_targets}for(let e=0,t=r.length;e<t;e++){_[r[e]]=[];let t=r[e];for(let a=0;a<c;a++){let n=d,o=0;i.aoe_profile&&0<a?o=verminted.damage.getDamage(i.weapon,i.aoe_profile,n,t,a,l):(("headshot"===r[e]||"both"===r[e])&&(n=m),o=verminted.damage.getDamage(i.weapon,i.profile,n,t,a,l)),_[r[e]][a]=o}}}return _};return t.clearAttacks=function(){for(let e=0,t=chain.length;e<t;e++)chain.pop()},t.generateCombo=function(){for(let e=0,t=chain.length;e<t;e++);},t},ComboBreakpoints=function(e){var t=Math.round,a=Math.ceil,n=Math.floor;let o=WeaponBreakpoints(e);o.headshot_chance=0,o.armor_types=constants.armor_types;let r={},s=function(i){if(0>i)return;let s=o.chain,p=o.damage_profiles,l=verminted.difficulty,c=o.hit_types,d=e.container,m=Object.keys(o.mob_lookup);for(let s,d=0,_=m.length;d<_;d++){s=m[d];for(let e,t=0;t<p.length;t++)e=o.pullDamage(m[d],t),p[t].damage[m[d]]=e;let _=data.breeds[m[d]].max_health[l];verminted.platform&&data.breeds[m[d]].console_max_health&&data.breeds[m[d]].console_max_health[l]&&(_=data.breeds[m[d]].console_max_health[l]),r[m[d]]=0;for(let e=0,t=p.length;e<t;e++)if(p[e].dot)continue;else if(p[e].damage[m[d]]&&p[e].damage[m[d]].neither){let t=p[e].damage[m[d]].neither.length;t>r[m[d]]&&(r[m[d]]=t)}for(let o=0;o<c.length;o++)for(let l=0;5>l;l++){if(l>=r[m[d]]){for(let t=l;5>t;t++)e.breeds[m[d]].targets[t].row.classList.add("hide");break}let i=e.breeds[s].targets[l][c[o]],u=TooltipControl(i),h=`${m[d]}\r\n${c[o]}`,g=e.breeds[s].mob_name,w=s.replace(/_/g," "),b=w.replace(/\w+/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1)});g.textContent=b+" ("+_+")";let f={},y=[],k=0,x=[],v=0;for(let e=0,t=p.length;e<t;e++){let t=p[e],a=y.length;if(!(p[e].damage[m[d]]&&p[e].damage[m[d]][c[o]]))y[a]=0;else if(t.dot){if("number"==typeof t.target&&l!==t.target)continue;else if(t.max_stacks){if(f[t.profile]=f[t.profile]||0,f[t.profile]>=t.max_stacks)continue;f[t.profile]++}let i=n(p[e].duration/p[e].tick_rate);for(let n=0;n<i;n++)y[a]=p[e].damage[m[d]][c[o]][0]||0,a++,h+=`\r\n${t.action} = ${y[a]&&y[a].toFixed(3)||0}`}else y[a]=p[e].damage[m[d]][c[o]][l]||0,h+=`\r\n${t.action} = ${y[a].toFixed(3)}`}for(let e,a=0;a<y.length;a++)e=t(4*y[a])/4,k+=e,x[a]=y[a]/_,v+=x[a];let C=[];if(0==k/_)i.textContent=0;else if(1<=k/_)i.textContent=1;else if(1>k/_){let e,o,r;0==_%k?(r=_/k,e=_/k-1,o=_/k/e):(r=a(_/k),e=n(_/k),o=_/k/e);let s=a(4*(_/e))/4;for(let e=0;e<y.length;e++){C[e]=C[e]||{};x[e]*(1/v);C[e].next_bp=y[e]?t(4*(y[e]*o))/4:0}let p=o;for(;;){let e=0,t=[],a=[];for(let n=0;n<C.length;n++)if(0<C[n].next_bp){if(e+=C[n].next_bp,C[n].percent=(C[n].next_bp-1/8)/y[n],!t[0]||C[n].percent>t[0].percent){for(let e=0;e<t.length;e++)t.pop();t[0]={},t[0].percent=C[n].percent,t[0].index=n}else if(C[n].percent===t[0].percent){let e=t.length;t[e]={},t[e].percent=C[n].percent,t[e].index=n}if(!a[0]||C[n].percent<a[0].percent){let e=a.length;for(let t=0;t<e;t++)a.pop();a[0]={},a[0].percent=C[n].percent,a[0].index=n}else if(C[n].percent===a[0].percent){let e=a.length;a[e]={},a[e].percent=C[n].percent,a[e].index=n}}if(e>s){let a=4*e-4*s;if(t.length<a)for(let e,a=0;a<t.length;a++)e=t[a].index,C[e].next_bp-=.25;else{p=t[0].percent;break}}else if(e===s){p=t[0].percent;break}else if(e<s)if(a.length)for(let e,t=0;t<a.length;t++)e=a[t].index,C[e].next_bp+=.25;else{break}let n=a.length;for(let e=0;e<n;e++)a.pop()}h+=`\r\n\r\npower needed for next bp: ${a(1e5*(p-1))/1e3}%`,p=a(100*p),100<p&&(p-=100),i.textContent=r+" ("+p+"%)"}u.text(h),e.breeds[m[d]].targets[l].row.classList.remove("hide")}}d.classList.remove("hide")},p={},l=function(t){let a=o.chain,r=o.damage_profiles,s=o.armor_types,l=e.info.damage_box,c=e.info.damage_box.dps;for(let e=0,a=o.armor_types.length;e<a;e++){3==e&&(e=4);let a=s[e];if(l.dps[o.armor_types[e]])var d=l.dps[o.armor_types[e]];else{var d=document.createElement("div");d.classList.add(o.armor_types[e]),l.dps[o.armor_types[e]]=d,l.container.appendChild(l.dps[o.armor_types[e]])}let c=0;for(let e,s=0,i=r.length;s<i;s++)if(e=r[s],!!e.profile)if(e.dot){let o=n(e.duration/e.tick_rate),i=verminted.damage.getDamage(e.weapon,e.profile,a,"neither",0);if(!e.max_stacks)c+=i*o;else if(p[e.name])continue;else c+=i*o*t,p[e.name]=!0}else{let t=o.headshot_chance,n=verminted.build.getWeaponIndex(r[s].weapon),i=verminted.build.weapon[n].crit_chance||.05;data.weapons[r[s].weapon].actions[e.action]&&data.weapons[e.weapon].actions[r[s].action].extra_crit_chance&&(i+=data.weapons[e.weapon].actions[e.action].extra_crit_chance);let p=t*i;t-=p,i-=p;let l=1-(t+i+p),d=0,m=0,_=0,u=0;d+=verminted.damage.getDamage(e.weapon,e.profile,a,"neither",0),m+=verminted.damage.getDamage(e.weapon,e.profile,a,"headshot",0),_+=verminted.damage.getDamage(e.weapon,e.profile,a,"critical",0),u+=verminted.damage.getDamage(e.weapon,e.profile,a,"both",0),d*=l,m*=t,_*=i,u*=p;let h=d+m+_+u;c+=h}0<t&&(c/=t,d.textContent=n(10*c)/10)}},c=function(){let t=o.chain,n=e.info.attack_speed,r=0,s=!1;if(1<t.length){let e=t.length-1,a=data.weapons[t[e].weapon],n=verminted.build.getWeaponIndex(t[e].weapon),o=verminted.build.weapon[n].attack_speed||1;if(t[e].weapon!==t[0].weapon)r+=a.actions[t[e].action].attack_speed.anim_cancel/o,r+=verminted.anim_cancel,s=!0;else if(a.actions[t[e].action]&&a.actions[t[e].action].attack_speed[t[0].action]){let n=a.actions[t[e].action].timeout,i=a.actions[t[e].action].attack_speed[t[0].action]-a.actions.neutral.attack_speed[t[0].action];r+=n&&n<i?n:i/o,s=!0}else if(a.actions.push&&t[0].action===a.actions.push.push_attack)switch(t[e].action){case"anim_cancel":r+=0;break;case"block":r+=0;break;default:let n=a.actions[t[e].action].attack_speed.block,i=a.actions[t[e].action].damage_window;r+=n<i?i/o:n/o,s=!0;}else"anim_cancel"===t[e].action&&(r+=verminted.anim_cancel,s=!0)}for(let e=0,a=t.length;e<a;e++){let a=verminted.build.getWeaponIndex(t[e].weapon),n=verminted.build.weapon[a].attack_speed||1;r+=data.weapons[t[e].weapon].actions[t[e].action]&&data.weapons[t[e].weapon].actions[t[e].action].timeout&&data.weapons[t[e].weapon].actions[t[e].action].timeout<t[e].speed*n?data.weapons[t[e].weapon].actions[t[e].action].timeout:t[e].speed/n}r=a(100*r)/100,n.textContent=r+"s",s&&l(r)};return o.addAttack=function(e,t,a){let n=o.chain,p=o.damage_profiles;if(0===a&&(r={}),a<n.length){let e=n[a].profile_length-1;for(let t=p.length;t>e;t--)p[t]=null,p.pop();for(let e=n.length;e>a-1;e--)n[e]=null,n.pop()}n[a]={},n[a].weapon=e,n[a].action=t,n[a].speed=0,n[a].profile_length=p.length;let l=a,d=data.weapons[e].actions[t];if(d){let o=d.damage_window;for(let e=0;e<n.length;e++)o+=n[e].speed;n[a].tth=o;let r=p.length;if(d.damage_profile_target){let n=d.damage_profile_target;p[r]={},p[r].weapon=e,p[r].weapon_index=a,p[r].profile=n,p[r].action=t,p[r].tth=o,p[r].damage={},p[r].aoe_profile=d.damage_profile,r++}else if(d.damage_profile){let n=d.damage_profile;p[r]={},p[r].weapon=e,p[r].weapon_index=a,p[r].profile=n,p[r].action=t,p[r].tth=o,p[r].damage={},r++}else if(d.damage_profile_left){let n=d.damage_profile_left;p[r]={},p[r].weapon=e,p[r].weapon_index=a,p[r].profile=n,p[r].action=t,p[r].tth=o,p[r].damage={},r++,n=d.damage_profile_right,p[r]={},p[r].weapon=e,p[r].weapon_index=a,p[r].profile=n,p[r].action=t,p[r].tth=o,p[r].damage={},r++}let s=p.length;for(let l=n[a].profile_length;l<s;l++){let n=data.profiles[p[l].profile],i=n.dot||n.default_target.dot;if(n.targets[0]&&n.targets[0].dot)if(i&&i!==n.targets[0].dot)throw"two dot profiles were found and not properly handled!";else{i=n.targets[0].dot;var m=0}if(i){let n=data.profiles[i];r=p.length,p[r]={},p[r].weapon=e,p[r].weapon_index=a,p[r].profile=i,p[r].action=t,p[r].tth=o,p[r].damage={},p[r].dot=!0,p[r].parent_index=l,p[r].tick_rate=n.tick_rate,p[r].duration=n.duration,p[r].max_stacks=n.max_stacks,p[r].target=m}}}if(!data.weapons[e].actions[t]){let e=a-1,o=data.weapons[n[e].weapon],i=o.actions[n[e].action];if("block"===t){let e=data.weapons[n[a-1].weapon].actions[n[a-1].action].attack_speed.block,t=data.weapons[n[a-1].weapon].actions[n[a-1].action].damage_window;n[a].speed+=e<t?t:e,n[a].speed+=o.block.min_hold}else{let e=data.weapons[n[a-1].weapon].actions[n[a-1].action].attack_speed.anim_cancel,t=data.weapons[n[a-1].weapon].actions[n[a-1].action].damage_window;n[a].speed+=e<t?t:e}--l}else{let o=data.weapons[e];if("melee"!==o.type||t!==o.actions.push.push_attack)0===a?n[a].speed=o.actions.neutral.attack_speed[t]:data.weapons[n[a-1].weapon].actions[n[a-1].action]?e===n[a-1].weapon?n[a].speed=o.actions[n[a-1].action].attack_speed[t]:(n[a].speed=o.actions.neutral.attack_speed[t],n[a].speed+=data.weapons[n[a-1].weapon].actions[n[a-1].action].attack_speed.anim_cancel):n[a].speed=o.actions.neutral.attack_speed[t];else if(n[a].speed=o.actions.push.attack_speed[t],n[a].speed+=o.block.min_hold,0<a)if(e===n[a-1].weapon){let e=0,t=0;data.weapons[n[a-1].weapon].actions[n[a-1].action]&&(e=data.weapons[n[a-1].weapon].actions[n[a-1].action].attack_speed.block,t=data.weapons[n[a-1].weapon].actions[n[a-1].action].damage_window),n[a].speed+=e<t?t:e}else{let e=data.weapons[n[a-1].weapon].actions[n[a-1].action].attack_speed.anim_cancel,t=data.weapons[n[a-1].weapon].actions[n[a-1].action].damage_window;n[a].speed+=e<t?t:e}}s(l),c()},o.refresh=function(){let e=o.chain;e[0]&&null!==verminted.build.getWeaponIndex(e[0].weapon)&&c(),s(e.length-1)},verminted.build.update_on_close[verminted.build.update_on_close.length]=o.refresh,o},AttackChain=function(e){let t={anim_cancel:.05,weapon:[]},a={};t.chain=[];let n=document.getElementById("TEMPLATE-CHAIN").content.firstElementChild,o=verminted.combo_breakpoints,i=function(e,o){let i=t.chain,r=[],s=0;for(let p=0,n=t.weapon.length;p<n;p++){let e=t.weapon[p],n=data.weapons[e];if(e&&"melee"===data.weapons[e].type){if(o&&o.weapon===t.weapon[p]&&data.weapons[o.weapon].actions[o.attack]){let t=data.weapons[o.weapon],a=t.actions[o.attack].attack_speed,n=Object.keys(a).sort();for(let t=0,a=n.length;t<a;t++)"block_cancel_end"!==n[t]&&(r[s]={},r[s].name=p+1+" "+n[t],r[s].attack=n[t],r[s].weapon=e,s++)}else{let t=data.weapons[e].actions.neutral.attack_speed,a=Object.keys(t);for(let t=0,n=a.length;t<n;t++)r[s]={},r[s].name=p+1+" "+a[t],r[s].attack=a[t],r[s].weapon=e,s++}let i=Object.keys(a[e].push),l=a[e].block.push;l+=a[e].push[i[0]],r[s]={},r[s].name=p+1+" push_attack",r[s].attack=n.actions.push.push_attack,r[s].weapon=e,s++}else if(e&&"ranged"===data.weapons[e].type)if(o&&o.weapon===t.weapon[p]&&"neutral"!==o.attack){let a,i=0;n.actions[o.attack]?a=n.actions[o.attack].attack_speed:(a=n.actions.neutral.attack_speed,"block"===o.attack?i=n.block.min_hold:"anim_cancel"===o.attack&&(i=t.anim_cancel));let l=Object.keys(a);for(let t=0,a=l.length;t<a;t++)"block_cancel_end"!==l[t]&&(r[s]={},r[s].name=p+1+" "+l[t],r[s].attack=l[t],r[s].weapon=e,s++)}else{let t=data.weapons[e].actions.neutral.attack_speed,a=Object.keys(t);for(let t=0,n=a.length;t<n;t++)r[s]={},r[s].name=p+1+" "+a[t],r[s].attack=a[t],r[s].weapon=e,s++}}for(let t=0,a=r.length;t<a;t++)r[t].node=document.createElement("option"),r[t].node.value=r[t].weapon+","+r[t].attack,r[t].node.textContent=r[t].name,e.appendChild(r[t].node);return r},r=function(a){let s,p=t.chain;if(a.target)s=a.target;else if(a.value)s=a;else throw`next chain had a problem`;let l=s.value.split(/,/),c={};c.weapon=l[0],c.attack=l[1];let d=parseInt(s.getAttribute("data-count"))||0,m=d+1;if(p[m])for(let t=p.length-1;t>=m;t--)e.removeChild(p[t].node),p.pop();p[m-1].weapon=l[0],p[m-1].action=l[1],p[m]={},p[m].node=e.appendChild(n.cloneNode(!0)),p[m].select=p[m].node.getElementsByClassName("chain-attack-dropdown")[0],p[m].select.setAttribute("data-count",m),i(p[m].select,c),p[m].select.addEventListener("change",r),o.addAttack(c.weapon,c.attack,d)};return t.refresh=function(){let a=t.chain,o=!1,s=null;for(let n=0,i=a.length;n<i;n++){let i=a[n].select.value.split(/,/),r=i[0];r!==t.weapon[0]&&r!==t.weapon[1]&&(o=!0),o&&(null===s&&(s=n-1),e.removeChild(a[n].node))}for(let t=a.length-1;t>=0;t--)a[t].node.parentNode&&e.removeChild(a[t].node),a.pop();a[0]&&e.removeChild(a[0].node),a[0]=a[0]||{},a[0].node=e.appendChild(n.cloneNode(!0)),a[0].select=a[0].node.getElementsByClassName("chain-attack-dropdown")[0],a[0].select.setAttribute("data-count",0),i(a[0].select),a[0].select.addEventListener("change",r)},t.setWeapon=function(e,n){t.weapon[n]=e,reverseLookup(e),a[e]=data.weapons[e].lookup,t.refresh()},t},WeaponSelection=function(e){let t={},a=verminted.weapon_list,n=verminted.attack_chain;t.update=[];let o=function(){let t=e.getAttribute("data-weapon-select");return verminted.weapon_slot[t]},i=function(t){let a=o();e.textContent=t,e.setAttribute("data-input",t);let r=verminted.update_weapon;for(let e=0,n=r.length;e<n;e++)r[e](t,a);n.setWeapon(t,parseInt(e.getAttribute("data-weapon-select")))};return e.addEventListener("click",function(t){a.setClickCallback(i);let e=verminted.update_weapon_list;for(let a=0,n=e.length;a<n;a++)e[a](t);a.open()}),t},ModalControl=function(t,a){let n={};return n.clickCallback=null,n.modal=t,n.body=document.getElementsByTagName("body")[0],n.open=function(){n.bind(),t.classList.remove("hide")},n.setClickCallback=function(e){n.clickCallback=e},n.close=function(){t.classList.add("hide"),n.body.removeEventListener("click",n.onClick)},n.onClick=function(o){o.stopPropagation();let e=o.target,i=!1;if(a)var r=a;else var r=t;for(;e&&e.classList;){if(e===r||e.classList.contains("weapon-list-holder")){i=!1;break}else if(e===document.body){i=!0;break}e=e.parentNode}i&&n.close()},n.bind=function(){n.body.addEventListener("click",n.onClick)},n},BuildBuild=function(){var t=Math.floor;let a=document.getElementsByClassName("build-modal-container")[0],n={};n.career={},n.career.name,n.career.multipliers={},n.items=[],n.weapon=[],n.weapon_lookup={},n.update_on_close=[];let o={container:document.getElementsByClassName("weapon-list")[0],modal:verminted.weapon_list,lookup:{},weapon:{},property_combos:{}},r=[],s={},p=document.getElementsByClassName("buff-container")[0],l={},c=[],d=[];for(let e=0;e<data.careers.bw_scholar.talent_tree.length;e++)d[e]={};let m={power_vs_unarmoured:"infantry",power_vs_armoured:"armored",power_vs_large:"monster",power_vs_frenzy:"berserker",power_vs_skaven:"skaven",power_vs_chaos:"chaos",power_level:"power"};n.modal=ModalControl(a,document.getElementsByClassName("build-modal")[0]),n.modal.open(),n.modal.close=function(){n.refresh(),n.modal.modal.classList.add("hide"),n.modal.body.removeEventListener("click",n.modal.onClick)};let _=function(t){let e=n.items,a=t.target.getAttribute("data-item-slot"),i=t.target.getAttribute("data-property-slot"),r=[];r[0]=e[a].property[0].select.value,r[1]=e[a].property[1].select.value;let s=e[a].type,p=o.property_combos[s];for(let n=0,o=e[a].property.length;n<o;n++)for(let t,o=0,i=e[a].property[n].options.length;o<i;o++)t=e[a].property[n].options[o].value,p&&p[r[(n+1)%2]]?p[r[(n+1)%2]][t]?e[a].property[n].options[o].removeAttribute("disabled"):e[a].property[n].options[o].setAttribute("disabled",!0):e[a].property[n].options[o].removeAttribute("disabled")},u=function(){let e,t,a=n.items;n.career.name?(e=data.careers[n.career.name],t=e.equipment):t=data.careers.dr_ranger.equipment;for(let n=0,i=a.length;n<i;n++){let i,r=t[n];if(i=data.weapons[a[n].name]?data.weapons[a[n].name].traits:1==n?"ranged_ammo":t[n],l[e]);else if(a[n].type===r&&a[n].trait_type===i)continue;else{a[n].type=r,a[n].trait_type=i;for(let e=0,t=a[n].property.length;e<t;e++){for(let t,o=0,i=a[n].property[e].options.length;o<i;o++)t=a[n].property[e].options.length-1,a[n].property[e].select.removeChild(a[n].property[e].options[t]),a[n].property[e].options.pop();let t=r;("ranged_ammo"===t||"ranged_heat"===t)&&(t="ranged");let i=document.createDocumentFragment(),s=Object.keys(o.property_combos[t]).sort();for(let t=0,o=s.length;t<o;t++){let o=s[t],r=document.createElement("option");r.value=o,r.textContent=o,a[n].property[e].options[t]=r,i.appendChild(r)}a[n].property[e].select.appendChild(i)}if(-1<n){let e=a[n].trait.options.length;if(0<e)for(let t,o=0;o<e;o++)t=e-1-o,a[n].trait.select.removeChild(a[n].trait.options[t]),a[n].trait.options.pop();let t=document.createDocumentFragment(),o=data.item.trait_combos[i].sort();for(let e=0,r=data.item.trait_combos[i].length;e<r;e++){let i=o[e],r=document.createElement("option");r.value=i,r.textContent=i,a[n].trait.options[e]=r,t.appendChild(r)}a[n].trait.select.appendChild(t)}}}},h=function(t){let e=t.target.value;if(n.career.name=e,n.career.crit_chance=data.careers[e].base_crit_chance,n.career.attack_speed=data.careers[e].base_attack_speed||0,n.career.reload_speed=data.careers[e].base_reload_speed||0,n.career.headshot_multiplier=data.careers[e].base_headshot_multiplier||0,n.career.backstab_multiplier=data.careers[e].base_backstab_multiplier||0,l[e]);else{u();let t=data.careers[e].talent_tree;for(let e=0;e<t.length;e++){d[e]={};for(let a,n=0;n<t[e].length;n++)a=t[e][n],c[e][n].div.classList.remove("not-active-talent"),c[e][n].div.textContent=a.name.replace(/_/g," ")}}y()},g=function(e,t){let a=n.career.name;if(!a)return;let o={power_level:"power"},r={attack_speed:"attack_speed",reload_speed:"reload_speed",critical_strike_chance:"crit_chance",backstab_multiplier:"backstab_multiplier"},s=data.careers[a].talent_tree;d[e]=s[e][t];let p=d[e];if(p.stat_buff&&p.max_stacks);else for(let e=0;5>e;e++){if(!d[e]||!d[e].stat_buff)continue;let t=d[e].stat_buff;o[t]?(0==e&&(n.career.multipliers[o[t]]=0),n.career.multipliers[o[t]]+=d[e].multiplier):r[t]&&(0==e&&(n.career[r[t]]=0),n.career[r[t]]+=d[e].multiplier)}for(let a=0;a<s[e].length;a++)a===t?c[e][a].div.classList.remove("not-active-talent"):c[e][a].div.classList.add("not-active-talent");y()},w=function(e,t){let a=n.items;t=t.getAttribute("data-weapon-slot"),a[t].name=e,u()},b=function(t){let e=n.items,a=t.target.getAttribute("data-item-slot"),o=t.target.getAttribute("data-property-slot"),i=t.target.value;e[a].property[o].name=i,e[a].property[o].value=data.item.properties[i][1]},f=function(e){let a=this,n=e.name,o=n.replace(/_/g," "),i=e.stat_buff,l=s[n];if(l)throw"buff "+n+" already exists!";else if(!i)throw"buff "+n+" has no stat_buff!";let c=0,d=e.max_stacks;"victor_zealot_passive_increased_damage"===n&&(d=6);let m=e.multiplier||e.bonus,_=document.createDocumentFragment(),u=document.createElement("div");u.classList="buff";let h=TooltipControl(u);h.text(o+"\n"+i+"\nbonus = "+m);let g=document.createElement("div");if(g.textContent=o,g.classList="buff-name",u.appendChild(g),1===d){let e=document.createElement("input");e.setAttribute("type","checkbox"),e.classList="buff-toggle",u.addEventListener("click",function(){e.value=!c,e.checked=!c,c=0+!c}),u.appendChild(e)}else if(1<d){let a=document.createElement("input");a.setAttribute("type","number"),a.setAttribute("max",d),a.setAttribute("min",0),a.classList="buff-input",a.addEventListener("change",function(o){let e=o.target.valueAsNumber;if(isNaN(e)){throw"buff "+n+" stacks are NaN!"}e=t(e);let i;e>d?(c=d,i=d):0>e?(c=0,i=0):(c=e,i=e),a.value=i}),u.appendChild(a)}else throw"buff "+n+" has no max_stacks!";_.appendChild(u),p.appendChild(_);let w=r.length;r[w]=this,s[n]=w,this.name=n,this.stat_buff=i,this.getBonus=function(){return m*c},this.remove=function(){let e=[],t={},a=0;for(let o,s=0;s<r.length;s++)o=r[s],o.name!==n&&(e[a]=o,t[o.name]=a,a++);r=e,s=t,p.removeChild(u)}},y=function(){let e=n.items,t=Object.keys(s);if(t.length!==r.length)throw"error with buff management";let a={},o=verminted.global_buffs,p=Object.keys(o);for(let e=0;e<p.length;e++)a[p[e]]=o[p[e]];if(n.career.name){let e=data.careers[n.career.name].passives;for(let t,n=0;n<e.length;n++)t=e[n],a[t.name]=t}for(let e=0;e<d.length;e++)d[e]&&d[e].name&&(a[d[e].name]=d[e]);for(let t=0;t<e.length;t++)e[t].trait.name&&(a[e[t].trait.name]=data.item.traits[e[t].trait.name]);for(let e=0,t=r.length;e<t;e++)a[r[e].name]||r[e].remove();let l=Object.keys(a);for(let e,t=0;t<l.length;t++)e=a[l[t]],isNaN(s[l[t]])&&e.stat_buff&&e.max_stacks&&new f(e)},k=function(e){let t=0;for(let a,n=0;n<r.length;n++)a=r[n],a.stat_buff===e&&(t+=a.getBonus());if(!data.careers[n.career.name])"crit_chance"===e&&(t+=.05);else if(m[e])for(let a,n=0;n<d.length;n++)a=d[n],e===a.stat_buff&&(t+=a.multiplier);else{t+=n.career[e]||0;for(let a,n=0;n<d.length;n++)a=d[n],e===a.stat_buff&&("crit_chance"===a.stat_buff?t+=a.bonus:t+=a.multiplier)}return t};return n.getMultipliers=function(){let e=n.items,t=n.weapon,a=n.weapon_lookup,o=[];for(let t=0,a=e.length;t<a;t++)if("charm"===e[t].type||"trinket"===e[t].type){let a=o.length;o[a]=e[t]}for(let e=0;e<a.length;e++)a.pop();for(let n,r=0,i=e.length;r<i;r++){if(n=e[r].name,t[r]={},!n&&!data.weapons[e[r].name])continue;a[n]=r,t[r].name=n,t[r].multipliers={},t[r].attack_speed=1+k("attack_speed"),t[r].reload_speed=1+k("reload_speed"),t[r].crit_boost=k("crit_boost"),t[r].power_boost=k("power_boost"),t[r].crit_chance=k("crit_chance"),t[r].headshot_multiplier=k("headshot_multiplier"),t[r].backstab_multiplier=k("backstab_multiplier"),t[r].has_power_boost=k("has_power_boost");let i=Object.keys(m);for(let e=0,a=i.length;e<a;e++)t[r].multipliers[m[i[e]]]=1+k(i[e]);let s=data.weapons[n].type;t[r].multipliers.power=t[r].multipliers.power*(1+k("power_level_"+s))*(1+k("damage_taken"));for(let a=0,n=o.length+1;a<n;a++){let n=o[a]?o[a].property:e[r].property;for(let e,a=0,o=n.length;a<o;a++)e=n[a],m[e.name]?t[r].multipliers[m[e.name]]+=e.value:"attack_speed"===e.name?t[r].attack_speed+=e.value:"crit_boost"===e.name?t[r].crit_boost+=e.value:"crit_chance"===e.name&&(t[r].crit_chance+=e.value)}}return t},n.getWeaponIndex=function(e){let t=n.items,a=n.weapon,o=n.weapon_lookup;return 0<=o[e]?o[e]:(n.getMultipliers(),o[e])},n.refresh=function(){let e=n.weapon;n.getMultipliers();for(let e=0,t=n.update_on_close.length;e<t;e++)n.update_on_close[e]();for(let t=0;t<e.length;t++)e[t].name&&expandWeaponInfo(e[t].name,verminted.weapon_slot[t])},function(){verminted.update_weapon[verminted.update_weapon.length]=w;let e=o.container,t=Object.keys(data.weapons).sort(),a=document.createDocumentFragment();for(let e=0,n=t.length;e<n;e++){let n=t[e],i=data.weapons[n].type,r=Object.keys(data.weapons[n].career);for(let e,t=0,a=r.length;t<a;t++){e=r[t],o.lookup[e]=o.lookup[e]||{},o.lookup[e][i]=o.lookup[e][i]||[];let a=o.lookup[e][i].length;o.lookup[e][i][a]=n}let s=document.createElement("div");s.classList="weapon-name js-button",s.setAttribute("data-weapon",n),s.textContent=n,o.weapon[n]={},o.weapon[n].div=s,a.appendChild(s)}e.appendChild(a)}(),function(){let e=a.getElementsByClassName("select-career")[0],t=document.createDocumentFragment(),n=Object.keys(data.careers).sort();for(let e,a=0,o=n.length;a<o;a++)e=document.createElement("option"),e.textContent=n[a],e.value=n[a],t.appendChild(e);e.appendChild(t),e.addEventListener("change",h)}(),function(){let e=a.getElementsByClassName("career-and-gear")[0],t=n.items;t[0]={},t[0].container=e.getElementsByClassName("item-container")[0];let o=t[0].container.cloneNode(!0),r=0;for(;5>t.length;){0!==r&&(t[r]={},t[r].container=t[r].container||o.cloneNode(!0)),t[r].property=[];for(let e,a=0;2>a;a++)e=document.createElement("select"),e.classList="select-property dropdown",e.setAttribute("data-item-slot",r),e.setAttribute("data-property-slot",a),e.addEventListener("change",_),e.innerHTML=`<option selected disabled hidden>property</option>`,e.addEventListener("change",b),t[r].property[a]={},t[r].property[a].select=e,t[r].property[a].options=[],t[r].container.appendChild(e);for(let e,a=0;1>a;a++){e=document.createElement("select"),e.classList="select-trait dropdown",e.innerHTML=`<option selected disabled hidden>trait</option>`,t[r].trait={},t[r].trait.select=e,t[r].trait.options=[],t[r].trait.name=null;let a=t[r].trait;e.addEventListener("change",function(t){let e=t.target.value;a.name=e;data.item.traits[e];y()}),t[r].container.appendChild(e)}e.appendChild(t[r].container),r++}for(let e,a=0;2>a;a++)e=document.createElement("div"),e.classList="select-weapon js-button",e.setAttribute("data-weapon-select",a),t[a].weapon={},t[a].weapon.div=e,t[a].container.classList.add("item-weapon"),t[a].container.prepend(e)}(),function(){let e=a.getElementsByClassName("talent-tree")[0],t=document.createDocumentFragment();for(let e=0;5>e;e++){c[e]=[];let a=document.createElement("div");a.classList.add("talent-row");for(let t,n=0;3>n;n++)t=document.createElement("div"),t.classList.add("talent"),c[e][n]={},c[e][n].div=t,a.appendChild(t),t.addEventListener("mousedown",function(){g(e,n)});t.appendChild(a)}e.appendChild(t)}(),function(){let e={},t=Object.keys(data.item.property_combos);for(let a=0,n=t.length;a<n;a++){e[t[a]]={};let n=data.item.property_combos[t[a]];for(let o=0,i=n.length;o<i;o++)e[t[a]][n[o][0]]=e[t[a]][n[o][0]]||{},e[t[a]][n[o][0]][n[o][1]]=!0,e[t[a]][n[o][1]]=e[t[a]][n[o][1]]||{},e[t[a]][n[o][1]][n[o][0]]=!0}o.property_combos=e}(),function(){let e=verminted.global_buffs,t=Object.keys(e);for(let a=0;a<t.length;a++)new f(e[t[a]])}(),u(),n.getMultipliers(),verminted.refresh[verminted.refresh.length]=n.refresh,verminted.update_weapon_list[verminted.update_weapon_list.length]=function(t){let e=n.career.name,a=Object.keys(o.weapon),r={};if(e){let a=t.target.getAttribute("data-weapon-select"),n=e,i=data.careers[n].equipment[a],s=o.lookup[n][i];for(let e=0,t=s.length;e<t;e++)r[s[e]]=!0}else for(let e=0,t=a.length;e<t;e++)r[a[e]]=!0;for(let e=0,n=a.length;e<n;e++)r[a[e]]?o.weapon[a[e]].div.classList.remove("hide"):o.weapon[a[e]].div.classList.add("hide")},n},WeaponListModal=function(){let t=ModalControl(document.getElementsByClassName("weapon-list-holder")[0]);return t.onClick=function(a){a.stopPropagation();let e=a.target,n=!0;for(;e&&e.classList;){if(e.classList.contains("weapon-list-holder")){n=!1;break}else if(e.getAttribute("data-weapon")){let a=e.getAttribute("data-weapon");t.clickCallback(a),n=!0;break}else e.classList.contains("select-weapon")&&(n=!1);e=e.parentNode}n&&t.close()},t},TooltipControl=function(e){if(verminted.tooltips[uniqueID(e)])return verminted.tooltips[uniqueID(e)];let t={},a=null,n=verminted.tooltip,o=null;return t.open=function(){let t=e.getBoundingClientRect();n.textContent=o,n.style.display="inline-block",n.style.left=t.right+n.offsetWidth+2>window.innerWidth?window.innerWidth-(n.offsetWidth+2)+"px":t.right-0+"px",n.style.top=t.bottom+"px"},t.close=function(){n&&(n.style.display="none"),clearTimeout(a)},t.bind=function(){e.addEventListener("mouseover",t.startTimer),e.addEventListener("mouseout",t.close)},t.startTimer=function(){a=setTimeout(function(){t.open()},400)},t.text=function(e){o=e},t.bind(),verminted.tooltips[uniqueID(e)]=t};function reverseLookup(e){if(data.weapons[e].lookup)return!1;let t={},a=data.weapons[e].actions,n=Object.keys(a),o={};o.lookup={},o.lookup["default"]=!0,o.current=0,o.buffer=[],o.buffer[0]="default",o.future=o.current+1;let i=function(r){t[r]={};for(let e,s=0,i=n.length;s<i;s++){if(e=a[n[s]],e.attack_speed&&e.attack_speed.parent){let a=Object.keys(e.attack_speed.parent);for(let i=0,p=a.length;i<p;i++)o.lookup[a[i]]||(o.lookup[a[i]]=!0,o.buffer[o.future]=a[i],o.future++),r===a[i]&&(t[r][n[s]]=e.attack_speed.parent[a[i]])}if(e.attack_speed.child){let t=Object.keys(e.attack_speed.child);for(let e=0,a=t.length;e<a;e++)o.lookup[t[e]]||(o.lookup[t[e]]=!0,o.buffer[o.future]=t[e],o.future++)}}o.current++,o.buffer[o.current]?(r=o.buffer[o.current],i(r)):data.weapons[e].block&&(t.block=t.block||{},t.block.push=data.weapons[e].block.min_hold,data.weapons[e].push&&(t.push=t.push||{}),t.block_cancel_end&&delete t.block_cancel_end,t.anim_cancel&&delete t.anim_cancel)};return i(o.buffer[0]),data.weapons[e].lookup=t,!0}function expandWeaponInfo(e,t){var a=Math.round;let n=constants.hit_types,o=constants.armor_types,i=verminted.build.getWeaponIndex(e),r=(""+verminted.platform+i+concateObject(verminted.build.weapon[i])).hashCode(),s=t.getAttribute("data-hash");if(r===s)return;t.setAttribute("data-hash",r);let p={neither:"normal",headshot:"headshot",critical:"critical",both:"both"},l=t;l.getElementsByClassName("weapon-title")[0].textContent=e;let c=data.weapons[e],d=Object.keys(c.actions).sort(),m=l.getElementsByClassName("attack"),_=verminted.damage,u=-1;"ranged"===data.weapons[e].type&&(u=0);for(let r=0,i=m.length;r<i;r++)if(r<d.length){let t=c.actions[d[r]].attack_speed,i=m[r].getElementsByClassName("attack-modifiers")[0];if(m[r].getElementsByClassName("weapon-attack-name")[0].textContent=d[r],i.textContent="",t){let e=m[r].getElementsByClassName("svg-attack-speed")[0],n=e.getElementsByTagName("use")[0],o=TooltipControl(n),i="Chain to:",s=Object.keys(t).sort().reverse();for(let e,n=0,o=s.length;n<o;n++)e=t[s[n]],e=a(100*e)/100,i+="\r\n"+e+"\t"+s[n];o.text(i)}let s={},l=m[r].getElementsByClassName("damage-table")[0];c.actions[d[r]].damage_profile?s[0]=c.actions[d[r]].damage_profile:(s[0]=c.actions[d[r]].damage_profile_left,s[1]=c.actions[d[r]].damage_profile_right);for(let t=0;6>t;t++){3==t&&(t=4);let i=t,r=t;5==t&&(i=1,r=5);for(let i=0;4>i;i++){let r,c;r=1==i||3==i?"headshot":null,c=!!(1<i);let d=!1,m=[],u=null,h=l.getElementsByClassName(constants.armor_types[t]+" "+constants.hit_types[i])[0],g=TooltipControl(h);for(let r,l=0;5>l;l++){r=0;for(let p=0,c=Object.keys(s).length;p<c;p++){if(data.profiles[s[p]]){let c=_.getDamage(e,s[p],o[t],n[i],l);r+=a(4*c)/4}m[l]=r}let c;!0==d||0<l&&m[l]>m[l-1]?(c=0,d=!0):0<m[l]%1?c=m[l].toFixed(2):c=m[l],0==l&&(h.textContent=m[0],u=constants.armor_types[t]+" - "+p[constants.hit_types[i]],u+="\r\nTargets:"),0<c&&(u+="\r\n  "+(l+1)+": "+c)}g.text(u)}}m[r].classList.remove("hide")}else m[r].classList.add("hide")}function assembleDiv(e,t,a,n){let o=n?document.createElement(n):document.createElement("div");return o.classList=e,a&&(o.textContent=a),t.appendChild(o),o}function assembleWeaponSheet(){var e={};e.table=document.createElement("div"),e.table.id="weapon-data",e.table.classList="hide",e.attack={};for(var t=0;16>t;t++){let a=assembleDiv("attack-container",e.table);e.attack[t]=assembleDiv("attack-type",a).textContent;let n=assembleDiv("damage-table",a);e.damage={};for(let t=0;5>t;t++){e.damage[constants.armor_types[t]]={};for(let a,o=0;4>o;o++)a=assembleDiv(constants.armor_types[t]+" "+constants.hit_types[o],n).textContent,e.damage[constants.armor_types[t]][constants.hit_types[o]]=a}}return e}function assembleWeapon(e,t,a,n,o){var i=o.weapons[t[n]],r="weapon-name";"ranged"===i.type&&(r="weapon-name weapon-ranged");var s=assembleDiv(r+" weapon-holder",e,t[n]);if(s.setAttribute("data-weapon",t[n]),i.career){let e=Object.keys(i.career),t=constants.characters,a={},n=!1;for(let o,i=0,r=e.length;i<r;i++)o=t[e[i]],o&&!a[o]&&(n?n+=","+o:n=o,a[o]=!0);s.setAttribute("data-character",n)}return s}function populateElements(){var e=document.createDocumentFragment(),t=document.getElementsByClassName("weapon-list")[0],a=Object.keys(data.weapons).sort(),n=constants.characters;let o=document.getElementsByClassName("attack")[0];for(let e=0;2>e;e++){let t="[data-weapon-slot='"+e+"']",a=document.querySelector(t).getElementsByClassName("attacks-container")[0];for(let t,n=0;n<9+e;n++)t=o.cloneNode(!0),a.appendChild(t)}}function populateAttackCombo(){let e={},t=data.breeds,a=Object.keys(constants.mob_lookup),n=constants.hit_types,o=constants.armor_types,i=verminted.max_targets,r=function(e,t){let a,o=data.breeds[e],r={},s=document.createElement("div"),p=o.primary_armor||o.armor;a=o.hitzone_primary_armor?o.hitzone_primary_armor.head:o.hitzone_armor?o.hitzone_armor.head:p;let l=document.createElement("div");l.classList.add("mob-name"),l.textContent=e,r.mob_name=l,s.appendChild(l),r.targets=[];for(let o,l=0;l<i;l++){o=document.createElement("div"),o.classList.add("breakpoint-row"),r.targets[l]={},r.targets[l].row=o;for(let e=0;e<n.length;e++){let t,i=n[e];t="headshot"===i||"both"===i?a:p;let s=document.createElement("div");s.classList.add(t),s.classList.add(i),r.targets[l][i]=s,o.appendChild(s)}s.appendChild(o)}return r.container=s,t.appendChild(s),r};e.weapon=[];let s=document.getElementsByClassName("weapon-breakpoints");for(let t=0;2>t;t++){e.weapon[t]={},e.weapon[t].container=s[t];let n=document.createElement("div");n.classList.add("breakpoint-plate");let o={};for(let e,t=0,i=a.length;t<i;t++)e=r(a[t],n),o[a[t]]=e;e.weapon[t].breeds=o,s[t].appendChild(n)}e.combo={},e.combo.container=document.getElementsByClassName("attack-combo")[0],e.combo.info={},e.combo.info.container=document.createElement("div"),e.combo.info.attack_speed=document.createElement("div"),e.combo.info.damage_box={},e.combo.info.damage_box.container=document.createElement("div"),e.combo.info.damage_box.dps={},e.combo.info.damage_box.container.classList.add("combo-damage-box"),e.combo.info.container.classList.add("combo-info"),e.combo.info.container.appendChild(e.combo.info.attack_speed),e.combo.info.container.appendChild(e.combo.info.damage_box.container),e.combo.breeds={};let p=document.createElement("div");p.classList.add("breakpoint-plate");let l={};for(let e,t=0,n=a.length;t<n;t++)e=r(a[t],p),l[a[t]]=e;return e.combo.breeds=l,e.combo.container.appendChild(e.combo.info.container),e.combo.container.appendChild(p),e}function prepPage(){document.getElementsByClassName("build-number")[0].textContent=build,constants=InitConstants();let e=document.getElementsByClassName("select-difficulty")[0],t=document.createDocumentFragment(),a=Object.keys(constants.difficulties);for(let e=0;e<a.length;e++){let n=a[e],o=document.createElement("option");o.textContent=n,o.value=n,n===verminted.difficulty&&o.setAttribute("selected",!0),t.appendChild(o)}e.appendChild(t),e.addEventListener("change",verminted.set_difficulty),verminted.update_weapon_list=[],verminted.update_weapon=[];let n=populateAttackCombo();verminted.combo_breakpoint_table=n.combo,verminted.weapon_breakpoint_table=[],verminted.weapon_breakpoint_table[0]=n.weapon[0],verminted.weapon_breakpoint_table[1]=n.weapon[1]}window.onload=function(){prepPage(),document.getElementsByClassName("build-number")[0].textContent+="-"+date,document.getElementsByClassName("build-number")[0].prepend(data.vt_build+"_"),verminted.global_buffs={victor_witchhunter_passive_debuff:data.careers.wh_captain.passives[0],markus_mercenary_passive:data.careers.es_mercenary.passives[0],markus_huntsman_passive_crit_aura:data.careers.es_huntsman.passives[3],trinket_grenade_damage_taken:data.item.traits.trinket_grenade_damage_taken,witch_hunter_captain_ultimate:{name:"witch_hunter_captain_ultimate",stat_buff:"crit_chance",max_stacks:1,bonus:.25},strength_potion:{name:"strength_potion",stat_buff:"has_power_boost",max_stacks:1,multiplier:1},speed_potion:{name:"speed_potion",stat_buff:"attack_speed",max_stacks:1,multiplier:.5}};let e=Object.keys(data.globals);for(let t=0,a=e.length;t<a;t++)constants[e[t]]=data.globals[e[t]];populateElements(),verminted.tooltip=document.getElementsByClassName("tooltip")[0],verminted.tooltips={},verminted.build=BuildBuild(),verminted.weapon_list=WeaponListModal(),verminted.damage=WeaponDamage(),verminted.combo_breakpoints=ComboBreakpoints(verminted.combo_breakpoint_table),verminted.attack_chain=AttackChain(document.getElementsByClassName("chain-attack-container")[0]),verminted.weapon_buttons={},verminted.weapon_slot={};let t=document.getElementsByClassName("select-weapon");for(let e=0,a=t.length;e<a;e++){let a=uniqueID(t[e]),n=verminted.tooltips[a];verminted.weapon_buttons[a]=WeaponSelection(t[e]),verminted.weapon_slot[e]=document.getElementsByClassName("weapon-attacks")[e],verminted.tooltips[a]=TooltipControl(t[e]),verminted.tooltips[a].text("Weapon "+(e+1))}verminted.update_weapon[verminted.update_weapon.length]=expandWeaponInfo;let a=document.getElementsByClassName("select-page");for(let e=0,t=a.length;e<t;e++)a[e].addEventListener("click",function(t){pageSelection(t.target)});let n=document.getElementsByClassName("build-button");for(let e=0,t=n.length;e<t;e++)n[e].addEventListener("click",function(t){verminted.build.modal.open(),t.stopPropagation()});let o=document.getElementsByClassName("input-power-level");for(let e=0;e<o.length;e++)o[e].value=verminted.power_level-185,o[e].addEventListener("change",verminted.set_power_level);let i=document.getElementsByClassName("select-platform")[0],r=TooltipControl(i);r.text`PC is accurate.\r\n\r\nConsole values are estimated by\r\ncommunity and will not be 100% accurate.\r\nCurrently only Legend is supported for:\r\nskaven slave\r\nskaven clan rat\r\nchaos fanatic\r\nchaos marauder`,i.addEventListener("change",verminted.set_platform);let s=document.getElementsByClassName("select-headshot-percent")[0];s.addEventListener("change",function(t){let e=t.target.valueAsNumber;e=100<e?100:0<e?e:0,s.value=e,verminted.combo_breakpoints.headshot_chance=e/100,verminted.build.refresh()})};